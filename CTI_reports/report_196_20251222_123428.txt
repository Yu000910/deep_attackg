On March 15, 2024, security teams at a fictional energy company, 'PowerGrid Inc.', detected anomalous activity indicative of a coordinated cyber intrusion. PowerGrid Inc., headquartered in Houston, Texas, operates multiple facilities across the southwestern United States, with a focus on renewable energy production. Initial logs from their web server showed unusual spikes in traffic from IP addresses associated with known malicious actors, but no immediate alerts were triggered.

The adversary, 'ShadowSupply', likely began by conducting reconnaissance to determine physical locations [T1591.001] of PowerGrid Inc.'s facilities through their corporate website, which listed addresses and contact details for offices in Arizona and Nevada. System administrators noted increased scanning activity on perimeter firewalls, but this was initially attributed to routine botnet noise.

Following reconnaissance, the actors employed malvertising [T1583.008] by embedding malicious code in online ads that exploited a vulnerability in Adobe Flash Player, targeting employees browsing news sites during work hours. Concurrently, they compromised the hardware supply chain [T1195.003] by distributing modified Teensy USB devices through a third-party vendor, which were later plugged into workstations at PowerGrid Inc.'s Nevada facility, as reported in internal IT support tickets.

To gain initial access, the adversary leveraged user execution [T1204] by hosting a compromised website that delivered a malicious PDF; when an employee in the finance department opened the PDF in their browser, it dropped and executed njRAT, establishing a foothold. The malware then used scheduled tasks [T1053] to set timers via 'timeSetEvent' for persistence and timed execution of subsequent stages.

For further persistence and reconnaissance, the actors modified the PowerShell profile [T1546.013] to run automated commands upon PowerShell startup, enabling continuous data collection. They also forged web credentials [T1606] by leveraging the AWS AssumeRole API to generate temporary security credentials for cross-account access into PowerGrid Inc.'s cloud infrastructure, as detected in anomalous IAM logs.

To escalate privileges, the adversary conducted credential stuffing [T1110.004] against remote services, using previously leaked credentials to obtain valid accounts for lateral movement. They then utilized Remote Desktop Protocol [T1021.001] to move laterally across the network, accessing servers in the Arizona data center.

To conceal command and control activities, the malware employed data obfuscation [T1001] through DLL injection with malicious.dll, hiding traffic in legitimate processes. Additionally, it used traffic duplication [T1020.001] via ROMMONkit's mirroring capabilities to automatically exfiltrate sensitive data, such as operational schematics and employee records, to external servers.

Finally, after exfiltration, the actors executed internal defacement [T1491.001] by encrypting files, capturing the desktop background, setting it to black, and changing the wallpaper to a bitmap image with the text 'All your files are encrypted! For more information see README-FOR-DECRYPT.txt', simulating ransomware deployment. Incident response teams at PowerGrid Inc. are currently investigating, with no real impact as this is a training scenario.