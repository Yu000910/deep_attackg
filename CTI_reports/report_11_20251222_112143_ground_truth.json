{
    "report_id": "report_11",
    "generated_at": "20251222_112143",
    "scenario_target_ids": [
        "T1189",
        "T1053.003",
        "T1546.007",
        "T1614",
        "T1080",
        "T1205.001",
        "T1048"
    ],
    "scenario_flow": [
        "initial-access",
        "execution",
        "persistence",
        "discovery",
        "lateral-movement",
        "command-and-control",
        "exfiltration"
    ],
    "llm_declared_ids": [
        "T1589",
        "T1189",
        "T1059.001",
        "T1105",
        "T1546.007",
        "T1053.003",
        "T1614",
        "T1080",
        "T1205.001",
        "T1048"
    ],
    "actual_found_ids": [
        "T1205.001",
        "T1048",
        "T1614",
        "T1546.007",
        "T1189",
        "T1589",
        "T1053.003",
        "T1059.001",
        "T1080",
        "T1105"
    ],
    "clean_text": "The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide information on a fictional APT campaign, 'ShadowCrypt', observed targeting financial organizations in a training scenario. This campaign demonstrates a multi-stage attack designed to exfiltrate sensitive data and deploy ransomware.\n\nBackground: The fictional victim, 'Global Finance Corp', reported anomalous network activity after employees accessed a compromised industry news website. Initial logs from their SIEM showed spikes in outbound FTP traffic and unauthorized file modifications in shared directories.\n\nAttack Narrative:\n1. Initial Access: The actors likely conducted reconnaissance to identify targets, then compromised a legitimate financial news website, injecting malicious JavaScript to exploit browser vulnerabilities in a drive-by compromise.\n2. Execution and Persistence: Upon successful exploitation, the malware employed PowerShell to download a ransomware payload and establish persistence by writing to the HKLM\\SOFTWARE\\Microsoft\\Netsh registry to load a malicious DLL through netsh.\n3. Discovery and Lateral Movement: The ransomware executed cron jobs to periodically encrypt new files in specific directories while using the GetLocaleInfoW API function to identify the system's country and language settings for targeted encryption. A compromised user account then wrote the ransomware executable to a company-wide shared storage location, tainting shared content to spread across the network.\n4. Command and Control: The actors configured the knockd service and firewall rules to only accept C2 connections from systems using a specified sequence of knock ports, implementing port knocking to evade detection.\n5. Exfiltration: Finally, the attacker used FTP to transfer stolen database files to an external server, performing exfiltration over an alternative protocol.\n\nIrrelevant Information: Global Finance Corp's internal investigation noted that the compromised website had previously passed security audits, and their firewall logs showed normal traffic patterns during off-hours, with no prior alerts for the injected JavaScript. The company's backup systems were unaffected, but restoration took 48 hours due to procedural delays.\n\nRecommendations: Organizations should implement web filtering, monitor for unusual cron job activity, audit registry changes related to netsh, and scrutinize FTP traffic for anomalies. This fictional scenario underscores the importance of layered defenses and continuous monitoring.",
    "tagged_text": "The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide information on a fictional APT campaign, 'ShadowCrypt', observed targeting financial organizations in a training scenario. This campaign demonstrates a multi-stage attack designed to exfiltrate sensitive data and deploy ransomware.\n\nBackground: The fictional victim, 'Global Finance Corp', reported anomalous network activity after employees accessed a compromised industry news website. Initial logs from their SIEM showed spikes in outbound FTP traffic and unauthorized file modifications in shared directories.\n\nAttack Narrative:\n1. Initial Access: The actors likely conducted reconnaissance [T1589] to identify targets, then compromised a legitimate financial news website, injecting malicious JavaScript to exploit browser vulnerabilities in a drive-by compromise [T1189].\n2. Execution and Persistence: Upon successful exploitation, the malware employed PowerShell [T1059.001] to download a ransomware payload [T1105] and establish persistence by writing to the HKLM\\SOFTWARE\\Microsoft\\Netsh registry to load a malicious DLL through netsh [T1546.007].\n3. Discovery and Lateral Movement: The ransomware executed cron jobs [T1053.003] to periodically encrypt new files in specific directories while using the GetLocaleInfoW API function to identify the system's country and language settings for targeted encryption [T1614]. A compromised user account then wrote the ransomware executable to a company-wide shared storage location, tainting shared content [T1080] to spread across the network.\n4. Command and Control: The actors configured the knockd service and firewall rules to only accept C2 connections from systems using a specified sequence of knock ports, implementing port knocking [T1205.001] to evade detection.\n5. Exfiltration: Finally, the attacker used FTP to transfer stolen database files to an external server, performing exfiltration over an alternative protocol [T1048].\n\nIrrelevant Information: Global Finance Corp's internal investigation noted that the compromised website had previously passed security audits, and their firewall logs showed normal traffic patterns during off-hours, with no prior alerts for the injected JavaScript. The company's backup systems were unaffected, but restoration took 48 hours due to procedural delays.\n\nRecommendations: Organizations should implement web filtering, monitor for unusual cron job activity, audit registry changes related to netsh, and scrutinize FTP traffic for anomalies. This fictional scenario underscores the importance of layered defenses and continuous monitoring.",
    "sentence_annotations": [
        {
            "sentence": "Initial Access: The actors likely conducted reconnaissance to identify targets, then compromised a legitimate financial news website, injecting malicious JavaScript to exploit browser vulnerabilities in a drive-by compromise.",
            "technique_id": "T1589",
            "technique_name": "Gather Victim Identity Information"
        },
        {
            "sentence": "Initial Access: The actors likely conducted reconnaissance to identify targets, then compromised a legitimate financial news website, injecting malicious JavaScript to exploit browser vulnerabilities in a drive-by compromise.",
            "technique_id": "T1189",
            "technique_name": "Drive-by Compromise"
        },
        {
            "sentence": "001] to download a ransomware payload and establish persistence by writing to the HKLM\\SOFTWARE\\Microsoft\\Netsh registry to load a malicious DLL through netsh [T1546.",
            "technique_id": "T1105",
            "technique_name": "Ingress Tool Transfer"
        },
        {
            "sentence": "003] to periodically encrypt new files in specific directories while using the GetLocaleInfoW API function to identify the system's country and language settings for targeted encryption.",
            "technique_id": "T1614",
            "technique_name": "System Location Discovery"
        },
        {
            "sentence": "A compromised user account then wrote the ransomware executable to a company-wide shared storage location, tainting shared content to spread across the network.",
            "technique_id": "T1080",
            "technique_name": "Taint Shared Content"
        },
        {
            "sentence": "Exfiltration: Finally, the attacker used FTP to transfer stolen database files to an external server, performing exfiltration over an alternative protocol.",
            "technique_id": "T1048",
            "technique_name": "Exfiltration Over Alternative Protocol"
        }
    ],
    "llm_raw_response": {
        "title": "Joint Cybersecurity Advisory: Fictional APT Campaign 'ShadowCrypt' Targeting Financial Sector",
        "summary": "This advisory details a simulated campaign by a fictional threat actor group, designated as 'ShadowCrypt', targeting financial institutions. The campaign involves drive-by compromises, ransomware deployment via cron jobs, persistence through Netsh Helper DLL, system discovery, tainted shared content, port knocking for C2, and exfiltration over FTP. This report is intended for blue team training to enhance detection and response capabilities.",
        "full_report_text": "The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide information on a fictional APT campaign, 'ShadowCrypt', observed targeting financial organizations in a training scenario. This campaign demonstrates a multi-stage attack designed to exfiltrate sensitive data and deploy ransomware.\n\nBackground: The fictional victim, 'Global Finance Corp', reported anomalous network activity after employees accessed a compromised industry news website. Initial logs from their SIEM showed spikes in outbound FTP traffic and unauthorized file modifications in shared directories.\n\nAttack Narrative:\n1. Initial Access: The actors likely conducted reconnaissance [T1589] to identify targets, then compromised a legitimate financial news website, injecting malicious JavaScript to exploit browser vulnerabilities in a drive-by compromise [T1189].\n2. Execution and Persistence: Upon successful exploitation, the malware employed PowerShell [T1059.001] to download a ransomware payload [T1105] and establish persistence by writing to the HKLM\\SOFTWARE\\Microsoft\\Netsh registry to load a malicious DLL through netsh [T1546.007].\n3. Discovery and Lateral Movement: The ransomware executed cron jobs [T1053.003] to periodically encrypt new files in specific directories while using the GetLocaleInfoW API function to identify the system's country and language settings for targeted encryption [T1614]. A compromised user account then wrote the ransomware executable to a company-wide shared storage location, tainting shared content [T1080] to spread across the network.\n4. Command and Control: The actors configured the knockd service and firewall rules to only accept C2 connections from systems using a specified sequence of knock ports, implementing port knocking [T1205.001] to evade detection.\n5. Exfiltration: Finally, the attacker used FTP to transfer stolen database files to an external server, performing exfiltration over an alternative protocol [T1048].\n\nIrrelevant Information: Global Finance Corp's internal investigation noted that the compromised website had previously passed security audits, and their firewall logs showed normal traffic patterns during off-hours, with no prior alerts for the injected JavaScript. The company's backup systems were unaffected, but restoration took 48 hours due to procedural delays.\n\nRecommendations: Organizations should implement web filtering, monitor for unusual cron job activity, audit registry changes related to netsh, and scrutinize FTP traffic for anomalies. This fictional scenario underscores the importance of layered defenses and continuous monitoring.",
        "techniques_used": [
            "T1589",
            "T1189",
            "T1059.001",
            "T1105",
            "T1546.007",
            "T1053.003",
            "T1614",
            "T1080",
            "T1205.001",
            "T1048"
        ]
    }
}