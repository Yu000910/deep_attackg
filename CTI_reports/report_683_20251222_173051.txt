The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide a fictional, educational overview of APT activity under the codename 'HomeLand Justice'. This report is based on a simulated attack scenario intended for training purposes, focusing on techniques observed in a hybrid infrastructure environment involving on-premises systems and cloud services.

Background: The fictional victim organization, 'GlobalTech Solutions', is a mid-sized manufacturing company with offices in North America and Europe, utilizing a mix of Windows servers, Linux systems, and Microsoft 365 for operations. Initial detection occurred via anomalous network traffic logs from a perimeter firewall, though no actual breach has occurred; this narrative is constructed for educational analysis.

Attack Narrative (Kill-Chain Structure):
- Initial Access: The actors likely conducted reconnaissance [T1589] to identify trusted relationships, then exploited a managed service provider's delegated permissions to gain administrative access through a trusted relationship [T1199], subsequently using default administrator accounts [T1078.001] to move laterally via RDP and Impacket tools. System logs from Active Directory showed multiple failed login attempts prior to successful access, but these were not tagged as malicious at the time.
- Execution: Upon gaining access, the adversary employed PowerShell [T1059.001] to actively download and execute malicious payloads [T1105] while simultaneously modifying registry keys [T1112] to configure a UserInitMprLogonScript [T1037.001] that would execute a backdoor upon each user login, ensuring persistence across reboots.
- Persistence: In addition to logon scripts, the threat actor installed a rogue systemd timer service [T1053.006] on Linux systems to execute data exfiltration scripts upon boot, leveraging cron jobs for scheduling that were not initially flagged in audit logs.
- Discovery: The malware conducted system network configuration discovery [T1016] using tools like OSInfo to gather current domain information, and performed virtual machine discovery [T1673] by executing 'vim-cmd vmsvc/power.getstate' across multiple VM IDs to identify powered-on virtual machines in the environment. Furthermore, the actors used PowerShell scripts to enumerate cloud accounts [T1087.004], specifically running 'Get-MsolRoleMember.ps1' to list members of administrative roles in Microsoft 365, though this activity blended with normal administrative tasks.
- Command and Control: To evade detection, the attacker utilized encoded DNS queries for DNS calculation [T1568.003] to tunnel command and control traffic through allowed DNS ports, mimicking legitimate DNS requests to bypass network security controls. Network traffic analysis revealed spikes in DNS query volumes, but these were initially attributed to routine domain lookups.
- Impact: No data exfiltration or disruption occurred in this fictional scenario; the focus is on training defenders to recognize these techniques. The company's incident response team simulated containment by disabling default accounts and reviewing trusted relationships.

Recommendations for Training: Blue teams should monitor for unusual use of default accounts, audit logon scripts and systemd timers, enhance DNS traffic analysis, and review cloud administrative role memberships regularly. This advisory serves as a resource for tabletop exercises and security awareness.