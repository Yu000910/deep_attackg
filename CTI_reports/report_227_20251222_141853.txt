Background: ShadowKey is a financially motivated APT group believed to operate in Eastern Europe, with campaigns dating back to early 2023. This report is based on a fictional incident at 'GlobalTrust Bank', where anomalous network traffic and system modifications were detected during a routine blue team exercise in October 2024. The bank's environment includes Windows 10 workstations, a mix of on-premises and Azure cloud services, and legacy SMB servers running outdated software.

Attack Narrative:
- Initial Access: The actors likely conducted reconnaissance by searching exploit databases for weaponized vulnerabilities matching the target's software stack [T1588.006], leading to the identification of an unpatched SMB service. They then sent a phishing email to an employee in the accounting department, which contained a link to a compromised website that downloaded and ran a trojan [T1566]. System logs show the email was opened at 09:15 UTC, triggering the download from a domain mimicking a legitimate software update site.
- Execution: Upon execution, the trojan employed AutoHotKey [T1059.010] to automate keystroke logging and data exfiltration while simultaneously altering a browser shortcut.lnk to run keylogger.exe before launching the legitimate application [T1547.009]. This allowed persistent access and evasion of basic endpoint detection. The malware then exploited an SMB weakness to execute arbitrary code on a remote machine [T1210], spreading laterally within the network and establishing a foothold on critical servers.
- Persistence and Defense Evasion: To maintain access, the adversary created a cloud instance in Azure [T1578.002], mounting a disk snapshot to extract credentials from a compromised system image and hide their infrastructure by utilizing an operational relay box (ORB) network consisting of compromised SOHO routers, IoT devices, and leased VPS to obfuscate the origin of C2 traffic [T1665]. Network monitoring tools recorded sporadic traffic from unusual IP ranges, but initial alerts were dismissed as noise due to the obfuscation techniques.
- Exfiltration and Impact: The campaign culminated in exfiltrating stolen data to the MEGA file sharing site [T1567.002] and employing a packet editor to alter financial transaction amounts during transmission to a banking server [T1565.002], resulting in simulated financial losses. Data logs indicate exfiltration occurred over encrypted channels during off-peak hours, with manipulated transactions detected during an audit review. The bank's incident response team contained the threat by isolating affected systems and applying patches, but the exercise highlighted gaps in cloud security monitoring and phishing awareness.

Recommendations: Organizations should prioritize patch management, implement multi-factor authentication, monitor for unusual cloud activity, and conduct regular phishing simulations. This fictional scenario serves as a training tool for blue teams to recognize complex, multi-technique attacks in real-world environments.