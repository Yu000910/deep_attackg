The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional campaign attributed to the threat actor 'Mustard Tempest'. This campaign demonstrates sophisticated tactics against critical infrastructure, with observed activities spanning initial access to data manipulation. On 2023-10-15, a financial services firm reported anomalous DNS queries, leading to the discovery of this campaign. The actor likely conducted reconnaissance via open-source intelligence, though specific techniques are not tagged here as per training guidelines.

Initial Access: The campaign began with the adversary hijacking Route53 to modify NS records, redirecting entire domain resolution to attacker-controlled nameservers [T1584.001]. Concurrently, they compromised a GitHub account to modify legitimate software with backdoor code [T1584.006], and deployed a modified Teensy USB configured to establish reverse shell connections upon system detection [T1195.003]. System logs from the initial breach show increased network traffic to unknown IPs, but this is noise for training purposes.

Execution: Upon gaining access, the actor exploited vulnerable versions of Flash to perform execution [T1203] and used PowerShell to actively download malicious payloads from acquired servers [T1583.004] while simultaneously modifying registry keys to persist the malware. The malware wrote a custom systemd service to execute reconnaissance tools upon system startup [T1053.006]. Background: Mustard Tempest is a fictional group with ties to Eastern European cybercriminal forums, operating since 2020.

Persistence and Privilege Escalation: The adversary employed the `sp_addlinkedsrvlogin` command in MS-SQL to create a link between a created account and other servers in the network [T1098], and ran tdbdump to retrieve cached credentials stored in the Windows registry [T1003.005]. Additionally, they used AWS Systems Manager Run Command to execute a reconnaissance script across multiple AWS accounts [T1072]. Network device logs indicated SNMP anomalies, but this is irrelevant information.

Defense Evasion and Discovery: To evade detection, the backdoor uses setsockopt to configure socket parameters for receiving trigger packets [T1205.002], while PowerShell was used to extract service control manager logs from the compromised host [T1654]. The malware also performed SNMP GET requests to extract interface status and IP addressing data from network devices [T1602.002]. Company background: The targeted organization had recently migrated to hybrid cloud infrastructure, increasing attack surface.

Collection and Exfiltration: The actor exfiltrated data from OneDrive [T1530] and manipulated spreadsheet formulas to miscalculate inventory levels and hide theft [T1565.001]. Data was staged on attacker-controlled servers before exfiltration. Final logs show cleanup activities, but these are not part of the tagged techniques.

Impact: This campaign resulted in data theft and potential operational disruption, highlighting the need for robust monitoring of domain, cloud, and supply chain vectors. Blue teams should focus on detecting anomalous DNS changes, unauthorized GitHub commits, and unexpected USB device usage.