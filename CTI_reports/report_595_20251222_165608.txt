On April 15, 2024, security analysts at a fictional company, 'TechGlobal Inc.', detected anomalous activity in their Azure and Kubernetes environments. TechGlobal Inc., a mid-sized software firm with 500 employees, reported unusual network traffic from external IP addresses, prompting an investigation. Initial logs showed increased DNS queries for internal domains, but no immediate alerts were triggered by the SIEM system.

The actors likely conducted reconnaissance by using a custom Python script to search WHOIS records for technical contact information of the victim's domains [T1596], identifying key personnel and infrastructure details. Following this, they leveraged DigitalOcean's free credit program to deploy attack infrastructure, including command-and-control (C2) servers [T1583.004], and downloaded a keylogger from a public file-sharing service to enhance their toolkit [T1588.001]. In the execution phase, attackers sent direct messages on Instagram pretending to be friends, containing links to compromised photo albums that redirected to malicious domains [T1566.003], leading to initial access via user interaction.

Once inside the network, the adversary employed systemd service files to establish persistence and run malicious code on boot [T1053.006], while simultaneously using CronJob to automatically deploy a malicious container that establishes C2 communication every 30 minutes [T1053.007]. To maintain elevated access, they modified the RoleBinding.yaml to add their service account to admin roles in the Kubernetes cluster [T1098.006] and altered the Azure Global Administrator account to bypass conditional access policies [T1666]. For evasion, malicious code overwrote /proc/7531/cmdline with '/usr/bin/curl' to masquerade as a legitimate network utility [T1036.011], and the threat actor used ListBuckets API calls to discover cloud storage resources accessible with stolen credentials [T1580]. Additionally, LuminousMoth utilized ARP spoofing to redirect a compromised machine to an actor-controlled website [T1557.002], modified HTTP Accept headers in encrypted sessions to avoid pattern matching through domain fronting [T1090.004], and employed RSA encryption for C2 communications to bypass signature detection [T1573].

Irrelevant system logs from TechGlobal Inc. indicated normal backup processes running at 2:00 AM UTC, with no correlation to the attack timeline. The company's background includes recent mergers, but this information is unrelated to the incident. Further analysis revealed that the actors exfiltrated approximately 50 GB of data over a week, but specific file types were not logged in the initial report.