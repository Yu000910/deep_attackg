### Background
CrimsonHaze, a fictional advanced persistent threat (APT) group, is assessed to have conducted a campaign against a multinational technology firm, 'TechGlobal Inc.', between January and March 2024. TechGlobal Inc. operates in over 50 countries with a focus on cloud services and IoT devices, and its internal logs show increased anomalous activity starting in late February, though initial access may have occurred earlier. The attack exploited a third-party service provider relationship to gain initial foothold.

### Attack Narrative
**Initial Access:** The actors exploited a trusted relationship with a delegated administrator account from a third-party IT service provider, 'SecureManage Solutions', to gain administrative access to TechGlobal's Microsoft 365 tenant [T1199]. This allowed them to bypass standard authentication controls and establish a persistent presence in the environment.

**Execution:** CrimsonHaze then employed content injection techniques by manipulating DNS and HTTP replies to redirect specifically-targeted employees within TechGlobal to a fake Windows Update page, where they downloaded a malicious ISO file [T1659]. The ISO contained a remote access trojan (RAT) disguised as a legitimate document, leveraging a phishing campaign that distributed these files via email to lure victims into executing the payload [T1204.002]. Once executed, the malware abused verclsid.exe to run a malicious component, evading application whitelisting defenses [T1218.012].

**Persistence and Privilege Escalation:** After execution, the actors harvested credentials from Windows Credential Manager on compromised hosts, manipulating account settings to maintain elevated access and move laterally [T1098]. They also bypassed Mark-of-the-Web security warnings by packaging the malware in ISO files, which avoided standard file-blocking mechanisms [T1553.005].

**Discovery:** To map the environment, CrimsonHaze used PowerShell.exe to query Active Directory for all enabled user accounts, identifying high-value targets and service accounts [T1087]. Simultaneously, the malware queried system locale information via GetSystemDefaultLCID to determine if execution occurred in Russian-speaking countries, potentially avoiding detection in those regions [T1614].

**Collection and Exfiltration:** The actors collected sensitive data from local systems, including intellectual property and financial records, using tools like StrifeWater [T1005]. They then employed RC4 encryption on the harvested data and exfiltrated it via FTP over a symmetric encrypted non-C2 protocol, masking the traffic as legitimate file transfers [T1048.001]. Additionally, the backdoor utilized raw sockets for port knocking to establish covert communication channels, sending command data directly through the network stack [T1205.001].

**Impact:** In the final stage, CrimsonHaze launched a direct network flood by mobilizing a botnet from thousands of compromised devices, including IoT endpoints within TechGlobal's network, to overwhelm critical servers and disrupt operations [T1498.001]. This caused significant downtime and data loss, with internal monitoring systems logging a 500% increase in network traffic during the incident.

### Recommendations
Blue teams should monitor for anomalous administrator account activity from third-party providers, inspect DNS and HTTP redirects, and implement application whitelisting with behavioral analysis. Regular credential audits and network traffic encryption checks are advised to detect and mitigate such campaigns.