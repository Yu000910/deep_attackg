The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional APT campaign. On April 15, 2024, a mid-sized technology firm, 'TechGlobal Inc.', reported anomalous network activity traced back to a social media-based initial access vector. TechGlobal Inc., founded in 2010, specializes in cloud infrastructure solutions and employs approximately 500 staff across three offices. Initial logs from their SIEM showed unusual outbound connections to unknown IP addresses, but no immediate alerts were triggered by their legacy antivirus software.

In the reconnaissance phase, the actors established fake social media accounts [T1585], posing as recruiters on Facebook to gather intelligence on target employees and organizational structure. This persona, 'Sarah Chen - Tech Recruiter', connected with several mid-level engineers over two weeks, sharing job postings that included malicious links. Concurrently, the campaign utilized stolen code signing certificates [T1588.003] to sign malware payloads, allowing them to bypass application whitelisting and evade initial detection mechanisms.

For initial access, a compromised website displayed a fake 'Java Runtime Error' message, urging users to copy and paste a malicious script into their terminals [T1204.004], which then executed PowerShell commands to download and run the signed malware. The malware, once active, employed GUI input capture [T1056.002] by generating a fake login window to steal credentials, while also performing OS credential dumping [T1003] using Mimikatz's sekurlsa::logonpasswords command to harvest additional credentials from memory. System logs from affected endpoints showed increased CPU usage during these activities, but no correlation was made with the earlier social media interactions.

For persistence and lateral movement, the actors used the stolen credentials to hijack SSH sessions [T1563.001] by exploiting weak key pairs on laterally connected Linux servers, and they added additional email delegate permissions [T1098.002] in Azure AD through a compromised global administrator account to backdoor a service principal with ApplicationImpersonation rights, enabling email collection from targeted mailboxes. The campaign maintained command and control (C2) by using proxy tools like FRPC [T1090] to establish reverse connections and dynamic resolution [T1568] through 'malware.exe' to communicate with attacker-controlled servers, with DNS queries observed to domains like 'update-server[.]com' that resolved to multiple IP addresses over time.

For exfiltration, the actors connected to unprotected Wi-Fi networks [T1669] to send stolen data, including exfiltrating encryption keys over a public WiFi hotspot [T1011] as part of a simulated ransomware deployment. Network traffic analysis revealed outbound connections on port 443 to IP addresses in foreign jurisdictions, but these were initially dismissed as benign due to lack of context. The campaign's use of multiple exfiltration methods highlights the need for comprehensive network monitoring beyond corporate perimeters.

TechGlobal Inc.'s incident response team eventually contained the threat after a week, but not before sensitive intellectual property was compromised. This scenario underscores the importance of user awareness training, robust credential management, and multi-layered defense strategies.