Background: CrimsonHaze is a fictional advanced persistent threat (APT) group assessed to target financial institutions and Managed Service Providers (MSPs) globally. In this training scenario, the actors exploit weak credential hygiene and shared environments to infiltrate networks, mimicking real-world tactics observed in historical campaigns. Initial logs from a compromised MSP server showed unusual login attempts from external IP addresses, but these were initially dismissed as false positives due to high network traffic during a routine system update.

Attack Narrative: The actors likely conducted initial reconnaissance [T1589] to identify target organizations and MSP relationships. They then employed credential stuffing [T1110.004] using a tool that cross-referenced 'breach_dump.txt' against employee email lists to exploit password reuse, gaining access to valid accounts [T1078] that were shared between an MSP and its client, allowing lateral movement between environments. Once inside, they used PowerShell [T1059.001] to execute a malicious script that scheduled tasks [T1053] via schtasks.exe to run ransomware.exe every Friday evening for persistence, while simultaneously modifying registry keys [T1112] to maintain access. To evade detection, the script included system checks [T1497.001] through a component called TerraLoader to analyze hardware and file information, ensuring it only executed in non-sandboxed environments. For command and control, the actors configured a compromised host to run a VNC service [T1219.002] on a non-standard port (e.g., 8443) for stealthy remote access, enabling further data exfiltration [T1048] and lateral movement. In the final stage, they deployed malicious code that initiated an OS exhaustion flood [T1499.001] via an ACK flood script to overwhelm the load balancer's resources, causing service disruption. Post-incident analysis revealed that the initial access was facilitated by weak password policies, and the scheduled tasks were hidden within legitimate system processes, delaying detection until after the first denial-of-service event.