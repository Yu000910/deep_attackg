The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional APT campaign dubbed 'ShadowDocker'. This scenario is based on observed tactics, techniques, and procedures (TTPs) in simulated environments and is intended for educational purposes only. No real entities are implicated.

Background: The fictional victim organization, 'CloudTech Solutions', is a mid-sized IT services provider with hybrid infrastructure spanning Microsoft Azure, Google Cloud Platform (GCP), and on-premises Windows servers. Routine system logs from last month showed unusual spikes in network traffic, but initial investigations flagged them as false positives related to a scheduled backup job. The company's security team later identified anomalous account creations in their Office 365 tenant, which triggered this advisory.

Attack Narrative:
In the Initial Access phase, the actors likely conducted reconnaissance by scanning databases [T1596.005] to identify misconfigured Docker daemons exposed online, while simultaneously using GCP Command Center queries [T1538] to discover cloud databases with weak authentication. Through a compromised partner relationship [T1199], they leveraged Office 365 partner privileges to create administrative accounts in client tenants, gaining initial foothold. System logs from the affected tenant show multiple failed login attempts from IP addresses geolocated to non-business regions, though these were initially dismissed as brute-force attacks from botnets.

Upon Execution, the adversary employed tools like AdFind to enumerate domain accounts [T1087.002] and extracted local account credentials using Mimikatz's lsadump::sam command on a compromised host [T1078.003]. For Persistence, they wrote a malicious PowerShell script named 'evil.ps1' to the Windows Startup folder [T1037] and used at.exe to schedule commands for deleting log files at midnight [T1053.002], while BADHATCH executed netstat.exe -f to discover system network connections [T1049]. In Lateral Movement, RedCurl placed modified LNK files on network drives to taint shared content [T1080], facilitating spread across the environment.

For Command and Control, HAMMERTOSS used steganography by appending commands to image files [T1001.002] to exfiltrate data covertly. The actors hid their infrastructure by routing C2 communications through a VPN service [T1665], evading network monitoring tools. Additional noise includes unrelated firewall alerts from a misconfigured IoT device and routine database maintenance logs that showed no signs of compromise.

Mitigation recommendations include reviewing partner access controls, enabling multi-factor authentication, monitoring for unusual scheduled tasks, and inspecting network traffic for VPN anomalies. This report serves as a training tool to enhance defensive postures against similar TTPs.