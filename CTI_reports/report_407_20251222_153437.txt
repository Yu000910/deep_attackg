The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to inform blue teams of a fictional APT campaign, dubbed 'Night Dragon', designed for training purposes. This scenario simulates an attack on a mid-sized energy company, 'PowerGrid Inc.', with operations across North America. The company's network includes Windows and macOS systems, with domain controllers managing user accounts. Initial analysis of firewall logs from early 2024 shows increased scanning activity from unknown IPs, though no immediate breaches were detected at that time.

The actors likely conduct reconnaissance by employing nmap's host discovery techniques to identify the victim's public IP blocks [T1590.005], mapping out network perimeters over a two-week period. Following this, they gained initial access through a compromised website that displayed a counterfeit 'Java Runtime Error' alert; when dismissed, it downloaded and executed ransomware via malicious copy and paste actions [T1204.004], exploiting user trust. Once inside, the malware wrote a persistent AppleScript to the user's LaunchAgents folder to run on every login [T1059.002], ensuring persistence on macOS endpoints. System logs from affected machines show unusual AppleScript executions at odd hours, but these were initially overlooked due to high network traffic during routine maintenance.

To evade detection, the trojan searches process memory for 'malware.exe' strings to identify sandbox environments [T1497.002] and employs debugger evasion by checking system flags, CPU registers, and APIs to determine if a debugger is present [T1622], delaying analysis. The actors then used domain accounts to gain further access to victim systems [T1078.002], leveraging stolen credentials. They extracted a high-privilege token using DuplicateToken to bypass access controls [T1134.001] and obtained memory dumps with ProcDump to parse and extract credentials from a victim's LSASS process memory with Mimikatz [T1003.001], while also using the `reg save` command to extract LSA secrets offline [T1003.004] for lateral movement. PowerGrid Inc.'s security team noted anomalous RDP sessions from internal IPs, but attributed them to remote work policies.

For lateral movement, the actors enabled the Remote Desktop Protocol for persistence and interacted with compromised systems to browse and copy files through RDP sessions [T1021.001], exfiltrating sensitive data over encrypted channels. Additionally, the botnet controller de-registered DNS A records for domains that were flagged by security vendors [T1568.001], using fast flux DNS to maintain command and control infrastructure. The campaign's impact includes potential data theft and operational disruption, though no real incidents occurred in this training scenario. Blue teams should monitor for these techniques in their environments.