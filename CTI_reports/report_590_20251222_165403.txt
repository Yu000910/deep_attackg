On April 15, 2024, security teams at a fictional manufacturing company, 'TechGlobal Inc.', detected anomalous activity across their Linux servers and Azure cloud environment. TechGlobal Inc., headquartered in Chicago with 500 employees, reported unusual network traffic and unauthorized access alerts following an employee plugging in an infected USB drive found in the parking lot. Initial logs from their SIEM showed failed login attempts from unknown IP addresses, but these were later determined to be false positives from a misconfigured firewall rule.

The adversary, identified as ShadowMimic, likely conducted reconnaissance [T1589] to identify high-value targets before deploying malware via removable media [T1091]. Once the USB drive was connected to a Linux workstation, the malware exploited a Unix shell [T1059.004] to execute arbitrary commands, creating a startup item directory at /Library/StartupItems [T1037.005] for persistence and modifying user roles in Azure to include Global Administrator privileges [T1098.003] for long-term control. Concurrently, the malware injected a malicious DLL into the lsass.exe process [T1055.002] to steal credentials while hooking network APIs [T1040] to monitor traffic and using NBTscan [T1018] to discover remote systems. Additionally, the actors employed the `net accounts` command [T1201] to discover password policies and injected encryption modules into SMB protocols [T1659] to corrupt file transfers, ultimately scheduling deletion of all blob storage objects within 24 hours using PutLifecycleConfiguration [T1485.001]. Unrelated system logs showed routine backup failures due to storage capacity issues, which were resolved independently.

This campaign demonstrates a multi-faceted approach combining on-premises and cloud-based techniques. Blue teams should enhance monitoring for unauthorized USB usage, review cloud role assignments regularly, and implement network segmentation to limit lateral movement.