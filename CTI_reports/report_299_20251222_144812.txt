The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with a fictional, educational scenario based on observed tactics, techniques, and procedures (TTPs) attributed to the SHADOWNET group. This report simulates an attack on a mid-sized technology firm, 'TechCorp Inc.', which specializes in cloud-based software solutions and uses Docker containers for application deployment. TechCorp's network logs from the past quarter show routine maintenance activities, including updates to their Active Directory servers and firewall configurations, with no prior indications of compromise.

Initial Access: The actors likely conducted reconnaissance through social media profiling and phishing campaigns, though specific logs from TechCorp's email gateway show only standard spam filtering. They gained initial access by using stolen legitimate account credentials [T1078] obtained from a previous breach at a third-party vendor, allowing them to authenticate to TechCorp's VPN as an employee. Upon entry, they executed a PowerShell script that utilized Windows Management Instrumentation [T1047] to deploy a malicious Chrome extension [T1176] designed for persistent command and control (C2) communication, while simultaneously running 'driverquery.exe /fo table' [T1652] to discover device drivers and using 'Get-DomainGPO.ps1' [T1615] to identify Group Policy Objects with weak security settings for potential privilege escalation.

Execution and Persistence: After establishing a foothold, the adversary employed 'docker exec -it compromised_container /bin/bash' [T1609] to gain interactive shell access within a container, where they modified registry keys to install a malicious DLL called portmon.dll in the system drivers directory [T1547.010] and replaced a DLL in the LSASS directory [T1547.008] to maintain persistence and credential access. They also used KOPILUWAK-derived tools to discover logical drive information [T1082] and stole web session cookies [T1539] from browser sessions to duplicate active sessions from other devices.

Command and Control and Exfiltration: The actors obfuscated their C2 traffic by implementing modified Base64 encoding with a rearranged alphabet [T1132.002] to evade detection by network monitoring tools. Additionally, they conducted DNS amplification attacks [T1498.002] by querying multiple open resolvers for large DNS records with spoofed source IPs, potentially as a diversion or to disrupt services. TechCorp's security team noted unusual spikes in DNS traffic during off-hours, but initial investigations attributed this to a misconfigured internal server. The campaign's objectives appear focused on data exfiltration and maintaining long-term access, with no evidence of ransomware deployment in this scenario.