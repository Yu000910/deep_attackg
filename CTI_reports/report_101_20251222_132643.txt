On October 15, 2023, PowerGrid Inc., a fictional energy provider based in Chicago, reported anomalous network activity, including increased DNS query volumes and unauthorized access to customer data in their Microsoft Dynamics 365 system. Initial logs from their SIEM showed spikes in traffic from IP addresses masquerading as legitimate Akamai CDN services, but further analysis revealed these were part of a coordinated attack. The company's background includes operations across five states, with a recent migration to cloud-based infrastructure, though no prior major incidents were recorded.

The attack began with reconnaissance, where the adversary created a deceptive Facebook profile with carefully crafted employment history and educational background to impersonate a trusted contractor [T1585.001], enabling initial social engineering attempts. Subsequently, the actors staged capabilities by uploading backdoor source code to a private Pastebin paste accessible only via a shared link [T1608], preparing for later deployment. For initial access, they employed artificial intelligence [T1588.007] to execute malicious.ps1, which automatically established persistence and maintained access to the victim's system while simultaneously injecting a backdoor payload into DNS queries to establish persistent communication channels [T1659].

During execution, the exploit targeted an XPC service daemon with weak input validation to achieve privilege escalation [T1559.003], allowing the adversary to run driverquery.exe /fo table to list device drivers in a formatted table for analysis [T1652] and modify registry keys to redirect video files to a compromised media player [T1565.003]. Persistence was further ensured by modifying a Docker image to include a web shell accessible through port 8080 [T1525], and the command and control infrastructure was hidden using hard-coded domains in the malware masquerading as legitimate services such as Akamai CDN or Amazon Web Services [T1665].

For lateral movement and credential access, Empire was used with Inveigh to conduct name service poisoning for credential theft and associated relay attacks [T1557.001], which facilitated access to Microsoft Dynamics 365, where compromised credentials were leveraged to gather customer data [T1213.004]. Data exfiltration involved ADVSTORESHELL collecting, compressing, encrypting, and exfiltrating data to the C2 server every 10 minutes [T1029], while an IP spoofing script was executed to evade IP-based blocking mechanisms during the attack [T1498]. Network logs from PowerGrid Inc. showed intermittent outages, but these were initially attributed to routine maintenance, delaying full incident response.