On March 15, 2024, a fictional financial services company, 'SecureFin Corp', reported anomalous activity in its hybrid Azure and on-premises environment. The company, which handles sensitive customer data and uses Azure VMs for critical applications, observed unauthorized access starting from an on-premises server. Initial investigation revealed that the threat actor, dubbed 'ShadowReaver', likely conducted reconnaissance to identify weak points, though no specific logs were captured during this phase. The attack began with the actor scanning the network for systems with enabled Guest accounts to gain initial access [T1078.001], exploiting a misconfigured Windows server that had default settings unchanged since deployment. System logs from the server showed failed login attempts prior to successful entry, but these were not flagged due to low-priority alerting thresholds.

Once inside, the actor executed malicious code that abused Azure RunCommand to disable security controls on Azure VMs [T1651], specifically targeting antivirus software and firewall rules to facilitate further movement. Concurrently, a script was inserted into profile.ps1 that establishes a reverse shell connection when PowerShell starts [T1546.013], ensuring persistence across sessions. The actor then used 'find / -perm +4000' to discover setuid executables with elevated privileges [T1548.001] on Linux-based VMs, leveraging these for privilege escalation. To maintain stealth, PolyglotDuke was deployed, storing encrypted JSON configuration files in the Registry [T1027.011] to evade file-based detection. Aquatic Panda components were observed using rundll32.exe to proxy execution of a malicious DLL file identified as a keylogging binary [T1218.011], while the threat actor injected a malicious DLL into explorer.exe to maintain persistence on the system via thread local storage [T1055.005].

For discovery, MuddyWater-inspired malware checked running processes against a hard-coded list of security tools often used by malware researchers [T1518.001], and the malware searched for Google Chrome installation paths to locate browser data directories [T1217] to harvest credentials and browsing history. Lateral movement involved reGeorg tunneling SMB sessions [T1021.002] to access internal shares, and the attacker used 'dir \\fileserver\shared\*.docx /s' to search for sensitive documents across network shares [T1039]. Data collection extended to the cloud, with malicious scripts collecting sensitive configuration files from an Amazon S3 bucket containing backup data [T1530]. Exfiltration was configured through the backdoor to communicate via POP3 for data transfer [T1071.003], and as a final act, the adversary changed recipient addresses in stored Outlook emails to redirect confidential communications [T1565.001], aiming to disrupt business operations. Incident responders noted that routine system maintenance logs from the previous week showed no anomalies, indicating the actor's ability to blend in with normal activity.