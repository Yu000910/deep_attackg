Background: On March 15, 2024, a fictional technology firm, 'InnovateSoft', reported anomalous activity in its development environment, including unauthorized access to source code repositories and credential theft. The company, which develops cloud-based applications for financial services, maintains a hybrid infrastructure with macOS workstations and Linux-based continuous integration (CI) servers. Initial logs showed unusual network traffic from developer systems to external IP addresses, but no immediate alerts were triggered by standard security tools.

Attack Narrative:
The actors likely conducted reconnaissance to identify key developers at InnovateSoft, though this phase was not directly observed in logs. In the initial access phase, the adversary sent spearphishing emails [T1566.002] to senior developers, containing links to a compromised vendor website that mimicked a legitimate software update portal. One developer clicked the link, leading to the download of a malicious installer that appeared to be a development tool. Concurrently, the attackers compromised the company's CI server by injecting malicious code into the build pipeline [T1195], which altered production builds to include a backdoor that would execute upon deployment.

Upon execution on a macOS workstation, the malware employed AppleScript [T1059.002] to write a script to the Documents folder that downloaded and executed additional payloads from a command-and-control (C2) server while simultaneously accessing the Keychain [T1555.001] to extract stored passwords and authentication tokens, copying them to a hidden file. The malware then staged the collected credentials and system data in a temporary folder [T1074.002] by running command-line utilities to gather process lists and network configurations, storing the output for later exfiltration.

To maintain persistence and evade detection, the actors deployed a malicious Docker image [T1204.003] that, when executed in a containerized environment, established a reverse shell to an external server, leveraging port knocking [T1205.001] to obscure the connection by sending raw socket packets through the network stack before initiating the shell. Finally, in the impact phase, the malware executed PowerShell commands to disable local administrator accounts [T1531] by running 'Set-LocalUser -Name 'admin' -Enabled $false', preventing legitimate user logins and disrupting administrative access to critical systems.

Irrelevant Information: InnovateSoft's internal monitoring showed increased CPU usage on the CI server during off-hours, but this was initially attributed to scheduled maintenance. The company's background includes a recent merger with a smaller startup, leading to integration challenges in their IT systems. System logs from the affected macOS workstation indicated multiple failed login attempts for a test account, but these were not correlated with the attack at the time.