The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with training on a fictional advanced persistent threat (APT) campaign designated 'Shadow Veil'. This campaign targets organizations in the energy and financial sectors, with initial reconnaissance indicating a focus on network segmentation weaknesses. The actors likely conduct reconnaissance [T1589] to identify potential entry points, though no specific techniques are tagged here as per the scenario.

In the Initial Access phase, Shadow Veil exploited a trusted relationship [T1199] by compromising a third-party vendor's Office 365 account, gaining administrative control over multiple client tenants, while simultaneously leveraging publicly available exploit code for a known vulnerability in remote services [T1588.006], such as CVE-2020-1472, to access Windows Active Directory servers [T1210]. The attackers used stolen payment information to rent a virtual private server (VPS) from a European hosting service [T1583.003], obscuring their identity and hosting malicious tools like QuasarRAT and Remcos [T1588.002].

During Execution, the adversary employed PowerShell [T1059.001] to download additional payloads [T1105] and schedule tasks using the 'at' command [T1053.002] for persistence at specific times. For persistence on Windows systems, they modified registry keys to set a malicious logon script path in HKCU\Environment\UserInitMprLogonScript [T1037.001], ensuring execution upon user login. On macOS, they altered the com.apple.dock.plist file [T1647] to load a custom plugin during dock initialization, enabling stealthy code execution.

In the Defense Evasion phase, Shadow Veil used thread execution hijacking [T1055.003] by suspending security processes with SuspendThread before injecting malicious code, while performing user activity-based checks [T1497.002] by scanning Windows event logs for 'malware.exe' process creation events to avoid detection. They also employed SID-History injection [T1134.005] to gain unauthorized access to sensitive file shares by manipulating security identifiers.

For Lateral Movement, the actors conducted LLMNR/NBT-NS poisoning and SMB relay attacks [T1557.001] using tools like Responder to harvest hashes and credentials from local networks, and exploited alternate authentication material [T1550] by abusing compromised AD FS servers' SAML tokens with tools similar to FoggyWeb for elevated access.

In the Command and Control (C2) phase, Shadow Veil utilized DNS tunneling [T1071.004], mimicking TEXTMATE's use of DNS TXT records for covert communication with their infrastructure. Network logs from the targeted organization showed increased DNS query volumes to suspicious domains, though these are untagged as noise. The campaign's objectives appear focused on data exfiltration and potential disruption of operational technology systems, with no evidence of ransomware deployment in this simulation.

Blue teams should monitor for anomalous registry changes, unusual scheduled tasks, and spikes in DNS traffic. Implementing network segmentation, multi-factor authentication, and regular patch management can mitigate these techniques. This report is fictional and intended for educational purposes to enhance defensive capabilities against similar real-world threats.