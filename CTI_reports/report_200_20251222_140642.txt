The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with a realistic training scenario based on fictional threat actor activity. In this simulated campaign, attributed to the group 'Shadow Serpent', actors targeted a mid-sized energy provider, 'PowerGrid Inc.', over a three-month period. PowerGrid Inc. operates several regional power plants and has a hybrid cloud infrastructure with on-premises servers running Linux and Windows systems. Initial logs from their SIEM showed unusual DNS queries to external domains, but no immediate alerts were triggered.

During the reconnaissance phase, the actors likely conducted searches on open technical databases [T1596], such as WHOIS records, to gather technical contact information for PowerGrid's domains, including admin emails and IP ranges. This was followed by gathering victim host information [T1592] through passive scanning of public-facing servers and social media profiles of employees, which revealed details about operating systems and network architecture. For instance, a script was used to query Shodan for exposed services on PowerGrid's web servers.

For initial access, the actors compromised accounts [T1586] via a phishing campaign targeting employees with fake corporate social media login pages, stealing credentials that were later used to access internal systems. Simultaneously, they compromised the software supply chain [T1195.002] by backdooring a software installer for a network monitoring tool hosted on a compromised third-party site, which was downloaded by PowerGrid's IT staff during a routine update, leading to the initial infection on a Linux server.

Upon execution, the malware employed native API calls [T1106] using obfuscated strings with LoadLibrary and GetProcAddress to dynamically import DLLs and evade detection, while also creating a systemd service [T1543.002] named 'update-checker.service' with a reverse shell command in the ExecStart directive to maintain persistence and allow remote command execution. System logs from the infected server showed unusual process spawns but were initially overlooked due to high system load.

For lateral movement, the actors used pass the ticket attacks [T1550.003] to move across the network by stealing Kerberos tickets from compromised workstations, and they abused remote desktop software [T1219.002] such as ScreenConnect and AnyDesk to gain interactive access to critical servers, including a database server storing sensitive operational data. During this phase, the malware collected clipboard data [T1115] from infected machines to capture copied passwords and other sensitive information, and it performed ARP cache poisoning [T1557.002] to intercept network traffic between critical servers, capturing frames to map internal communications and identify high-value targets.

For exfiltration, the actors used unencrypted non-C2 protocols [T1048.003], with a script decoding base64-encoded data received over the network to exfiltrate stolen information to a command-and-control server hosted on a compromised cloud instance. Finally, in the impact phase, the actors executed firmware corruption [T1495] by deploying an executable that installed a modified bootloader on key servers, preventing normal boot-up and causing operational disruption during a simulated grid stress test. PowerGrid Inc. reported intermittent outages, but full recovery was achieved after isolating affected systems in this training exercise.