PowerGrid Inc., a fictional energy provider with operations across the U.S., reported anomalous network activity starting on October 15, 2023, after an employee received a phishing email purporting to be from a trusted vendor. Initial logs from their SIEM showed multiple failed login attempts from external IPs, but these were dismissed as noise at the time. The actors likely conducted reconnaissance by scraping the company's public website, including the 'Contact Us' page, to determine physical locations [T1591.001] for potential future physical attacks or social engineering. Subsequently, they sent a spearphishing email with a malicious link designed to harvest user credentials when clicked [T1598.003], which led to the compromise of an employee account with limited privileges.

Upon gaining initial access, the adversary executed a multi-stage payload using odbcconf.exe to proxy execution of a malicious DLL [T1218.008], bypassing application whitelisting, while simultaneously employing the Windows Command Shell [T1059.003] to run scripts that enumerated local accounts on network shares [T1087.001] and queried the Global Address List via Exchange Web Services to collect corporate email addresses [T1087.003]. To maintain persistence, they used launchctl to load a payload as a system-level service [T1569.001] and placed a malicious DLL in a location where it would be loaded by print services [T1547.012]. For lateral movement, the actors injected Kerberos golden tickets to pass tickets across the network without detection [T1550.003], and they deployed a passive network tap to intercept unencrypted credentials from network traffic [T1200], allowing further escalation.

During the exploitation phase, the malware conducted application window discovery [T1010] to report window names along with keylogger data, providing context for targeted data theft. The actors established bidirectional communication using the Microsoft Graph API to connect to an actor-controlled OneDrive account [T1102.002], enabling them to download and execute additional files, run shell commands, and create directories to share exfiltrated data. In the final stage, as part of the impact objective, the attacker overwrote the BIOS firmware flash utility with a corrupted version [T1495], rendering several critical systems unbootable and causing operational disruption. PowerGrid Inc.'s incident response team, upon discovering the firmware corruption, initiated a full forensic investigation, which revealed the extent of the campaign and led to the containment efforts detailed in this advisory.