On June 15, 2024, a fictional financial institution, 'SecureBank Inc.', reported anomalous network activity traced to a sophisticated intrusion. SecureBank, with operations across North America, maintains a hybrid cloud environment using Microsoft Azure and on-premises servers running Windows Server 2019. Initial logs from their SIEM showed unusual PowerShell executions from a user workstation, but no immediate alerts were triggered due to misconfigured thresholds.

The attack began with the adversary conducting reconnaissance [T1589] to identify key employees, likely using open-source intelligence (OSINT) from LinkedIn and company websites. They then sent a targeted spearphishing email [T1566.002] to a finance department employee, containing a link to a malicious document hosted on a compromised website. The document, disguised as an invoice, prompted the user to enable macros, which executed a script to download a payload.

Upon execution, the adversary deployed a Docker container [T1610] on a compromised developer workstation, using 'docker start' to activate it; this container was configured with encrypted channels to communicate with command-and-control (C2) servers, evading network monitoring. To establish persistence, the backdoor modified the default file association for .txt files in the registry [T1546.001], altering HKEY_CLASSES_ROOT\txtfile\shell\open\command to execute a PowerShell script for C2, and simultaneously added a malicious VBScript to the user's Run registry key [T1037.002] to ensure automatic execution at logon.

The attacker then leveraged weak credentials, using the built-in Administrator account with a default password [T1078.001] to compromise the domain controller, gaining elevated privileges. They altered the Session Manager Environment registry key [T1574.012] to inject a malicious library into .NET runtime processes via COR_PROFILER, enabling code execution in memory. For discovery, they ran the gpresult command [T1615] to survey Group Policy details, aiding in lateral movement planning.

To collect sensitive data, the malware employed MailSniper [T1114.002] to search Exchange servers and harvest emails containing authentication credentials, while a keylogger was deployed [T1056] to hook credential input APIs and capture passwords from various applications transparently. All exfiltrated data was encoded using a modified Base64 scheme with URL-safe characters [T1132.002] to conceal C2 communications, making detection more challenging. Throughout the campaign, system logs showed increased network traffic to external IPs, but initial analysis dismissed it as benign due to lack of correlation with other events.