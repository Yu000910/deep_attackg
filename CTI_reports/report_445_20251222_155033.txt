Background: The fictional company 'TechGlobal Inc.', a mid-sized technology firm with operations in North America and Europe, reported anomalous network activity starting in early 2024. Initial logs from their SIEM showed unusual outbound connections from developer workstations, but no immediate alerts were triggered due to encrypted traffic patterns. The company's infrastructure includes a mix of Windows and Linux systems, with Active Directory for identity management and regular use of removable media for data transfers between secure environments.

Attack Narrative: The actors likely conducted reconnaissance [T1589] to identify targets, though no specific evidence was logged in this scenario. The campaign began with a supply chain compromise [T1195], where the adversary modified the 'development_tools.exe' installer used by TechGlobal's software team to include additional malicious payloads, which were then distributed through a compromised vendor update server. Upon installation, the malicious code exploited a vulnerability in Microsoft Word [T1203] to gain initial execution on a developer's workstation, leveraging a known CVE-2023-XXXXX flaw in document parsing. After execution, the adversary employed PowerShell [T1059.001] to extract plaintext passwords from the G$RADIUSCHAP attribute in Active Directory using reversible encryption techniques [T1556.005], while simultaneously creating a persistent system process [T1543] by modifying startup scripts in /etc/init.d/ on Linux systems to ensure survival across reboots. For further persistence, they configured a script to execute automatically through modification of the user's PowerShell profile [T1546.013], enabling ongoing access. To move laterally, the actors used the pass-the-hash technique [T1550.002] with stolen NTLM hashes, employing tools like Invoke-SMBExec to authenticate to other systems in the network without needing plaintext credentials. During lateral movement, they performed automated collection [T1119] by scanning for files with specific extensions (e.g., .docx, .pdf) and archiving them for exfiltration, while also searching removable media [T1025] using commands like 'findstr /s password *.txt' to locate additional credential files. In a parallel effort, the adversary deployed an evil twin access point [T1557.004] mimicking the corporate guest Wi-Fi to capture login credentials from unsuspecting employees, though this was detected by network monitoring tools. Finally, data exfiltration was achieved through IDE tunneling [T1219.001], where a compromised Visual Studio Code extension established SSH tunnels to covertly transfer collected data to external servers, blending with legitimate developer traffic to avoid detection. Throughout the campaign, routine system logs showed normal user activity, such as failed login attempts and scheduled backups, which were unrelated to the attack but added noise to the investigation.