The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training insights on a fictional Advanced Persistent Threat (APT) campaign, designated 'ShadowPhish'. This report is based on a simulated attack scenario designed for educational purposes, involving no real-world incidents. The target was a mid-sized financial services company, 'SecureFin Corp', with operations across North America. Initial analysis of system logs from SecureFin's SIEM indicated anomalous network traffic patterns, including increased DNS queries to unknown domains and unusual SSH login attempts from external IP addresses, though these logs are unrelated to the tagged techniques and serve as background noise.

The actors likely conducted reconnaissance by searching LinkedIn for employees of SecureFin Corp to identify potential targets [T1591] and gathering victim identity information through a spear phishing email crafted to appear as a legitimate security alert from the company's authentication provider [T1589]. For initial access, the attacker uploaded a PHP web shell to a vulnerable web server to maintain persistent access [T1650], while simultaneously using libpcap to sniff network traffic and identify open ports for command channels [T1205.001]. During execution, APT41 used Windows Management Instrumentation (WMI) in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit [T1047]. The attacker employed PowerShell to download malicious payloads, with the malware operator creating disposable email addresses using Guerrilla Mail's anonymous signup page for command and control communications [T1585.002] and applying a forged digital signature to their keylogger application using signtool.exe [T1587.002]. For persistence, the attacker inserted their SSH public key into the authorized_keys file of multiple user accounts [T1098.004] and added additional trusted locations to Azure AD conditional access policies [T1556.009]. In the credential access phase, threat actors used Mimikatz's DCSync to dump credentials from the memory of the targeted system [T1003.006] and extracted configuration repository data from the Active Directory database to gather domain administration details [T1602]. For collection, NightClub copied captured files and keystrokes to the `%TEMP%` directory of compromised hosts [T1074.001]. During exfiltration, the malware queried TXT records through DNS tunneling to bypass network egress filters [T1568.003] and encrypted stolen credentials using OpenSSL for secure transmission over asymmetric encrypted non-C2 protocols [T1048.002]. Additionally, malicious actors exploited ISP-level vulnerabilities to inject adware into HTTP responses [T1659], though this activity was detected in separate network logs and did not directly impact the core campaign. Blue teams should monitor for these techniques and implement network segmentation, multi-factor authentication, and regular patch management to mitigate similar threats.