Background: The fictional APT group 'SHADOWPACK' is assessed to operate with moderate sophistication, focusing on technology and financial sectors. In this scenario, they exploited a popular open-source JavaScript library used by multiple victim organizations for web analytics. The library's repository was compromised, allowing unauthorized modifications. System logs from victim networks show anomalous network traffic patterns beginning on October 15, 2023, with increased outbound HTTPS requests to unknown domains, though initial alerts were dismissed as false positives due to high network noise.

The actors first conducted reconnaissance to identify widely used software components, leading to the compromise of the JavaScript library's source code [T1195.002] by embedding a backdoor that activated upon execution in victim environments. Concurrently, they created a malicious Dockerfile [T1204.003] that silently installed keylogging software during container builds, targeting DevOps pipelines. Once deployed, the backdoor leveraged PowerShell to inject shellcode into legitimate svchost.exe processes [T1055.002] using WriteProcessMemory, enabling persistence and evasion. For command and control (C2), the malware employed non-standard encoding [T1132.002] by communicating via subdomains that utilized base64 with character substitutions, blending with normal DNS traffic. Finally, data exfiltration was performed over asymmetric encrypted non-C2 protocols [T1048.002], mimicking the SolarWinds compromise by sending collected data via HTTPS requests to password-protected archives staged on victim OWA servers, bypassing traditional network monitoring tools. Additional noise includes routine system updates and unrelated firewall logs that obscured initial detection efforts.