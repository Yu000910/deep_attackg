On 2023-10-15, a financial services company, 'SecureBank Inc.', reported anomalous activity on its internal network. SecureBank, headquartered in New York with 5,000 employees, operates a hybrid cloud environment using AWS and on-premises Windows servers. Initial logs showed unusual PowerShell executions from a user workstation, but no immediate alerts were triggered by the SIEM system, which had been experiencing minor latency issues due to a recent software update.

The attack began when an employee visited a compromised industry news website that displayed a fake 'Java Runtime Error' message, urging the user to copy and paste a malicious script into a terminal to fix the issue [T1204.004]. The script, written in AutoHotKey, executed automatically upon pasting, downloading and running a payload from a command-and-control (C2) server [T1059.010]. This payload performed internet connection discovery by pinging internal IP addresses to confirm network connectivity before establishing C2 channels [T1016.001].

Once inside, the adversary used stolen credentials, likely obtained from earlier phishing campaigns, to authenticate to multiple systems, including a domain controller, using pass-the-hash techniques with tools like pth.exe to move laterally without needing plaintext passwords [T1078, T1550.002]. They then conducted permission groups discovery by running commands such as 'net group "Enterprise Admins"' to identify high-privileged accounts across the forest [T1069]. Network traffic logs indicated increased SMB activity during this phase, but no alerts were generated due to misconfigured thresholds.

To maintain persistence and expand control, the attacker leveraged AWS Systems Manager Run Command to deploy a backdoor across all managed cloud instances, simulating legitimate software updates [T1072]. Additionally, they set up internal proxies using custom tools to create SOCK5 and custom protocol proxies between infected hosts, facilitating covert communication and data exfiltration [T1090.001]. SecureBank's incident response team noted that these activities blended with normal administrative traffic, delaying detection until a routine audit flagged unusual proxy configurations on a server in the London office, which had been undergoing maintenance that week.