The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to highlight tactics, techniques, and procedures (TTPs) associated with the fictional APT group 'ShadowGale'. This campaign, observed in a training environment, demonstrates a multi-stage attack against a simulated energy sector organization.

Initial reconnaissance activities involved the adversary querying a paid threat intelligence feed to gather details about the target organization's security tools [T1597.001] while simultaneously searching the victim's careers page for office addresses in different cities to determine physical locations [T1591.001]. System logs from the compromised environment show that the script ran wevtutil.exe to extract hardware inventory information from Windows event logs [T1592.001], though these logs also contained routine backup entries unrelated to the attack.

Initial access was achieved through a trusted relationship, where the threat actor utilized delegated administrative rights to bypass security controls and access sensitive data [T1199]. Once inside, execution involved deploying a container to run the Doki malware [T1610] and dropping a malicious Amazon Machine Image with pre-installed keylogging software to the cloud repository [T1204.003]. Persistence was established by altering termsrv.dll to create a persistent RDP backdoor [T1505.005], while credential access techniques included OS credential dumping to obtain Windows logon password details [T1003] and web portal capture by redirecting text-based login codes to attacker-controlled websites during credential changes [T1056.003].

Lateral movement and impact were facilitated through DHCP spoofing, where the adversary executed dhcpspoof.exe to poison the network with fraudulent DHCP responses [T1557.003]. Command and control (C2) communications were masked using a Tor gateway to anonymize the traffic [T1665] and employed non-application layer protocols, with StealBit using the Windows Socket networking library to communicate with attacker-controlled endpoints [T1095]. Additional network scans revealed unrelated port 445 traffic, which was not part of the malicious activity.