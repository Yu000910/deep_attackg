{
    "report_id": "report_64",
    "generated_at": "20251222_114252",
    "scenario_target_ids": [
        "T1593.002",
        "T1585.003",
        "T1586.002",
        "T1189",
        "T1569.003",
        "T1047",
        "T1525",
        "T1037.003",
        "T1218.001",
        "T1036.007",
        "T1526",
        "T1673",
        "T1069.003",
        "T1008"
    ],
    "scenario_flow": [
        "reconnaissance",
        "resource-development",
        "resource-development",
        "initial-access",
        "execution",
        "execution",
        "persistence",
        "privilege-escalation",
        "defense-evasion",
        "defense-evasion",
        "discovery",
        "discovery",
        "discovery",
        "command-and-control"
    ],
    "llm_declared_ids": [
        "T1593.002",
        "T1586.002",
        "T1585.003",
        "T1189",
        "T1569.003",
        "T1047",
        "T1525",
        "T1037.003",
        "T1218.001",
        "T1036.007",
        "T1526",
        "T1673",
        "T1069.003",
        "T1008"
    ],
    "actual_found_ids": [
        "T1569.003",
        "T1008",
        "T1037.003",
        "T1036.007",
        "T1593.002",
        "T1189",
        "T1047",
        "T1218.001",
        "T1069.003",
        "T1526",
        "T1585.003",
        "T1673",
        "T1525",
        "T1586.002"
    ],
    "clean_text": "On March 15, 2024, SHADOWCRAWL initiated reconnaissance by using search engines to identify vulnerable servers and researching victim infrastructure through compromised personal email accounts to gather credentials and internal communications. The actors established a Dropbox Paper workspace to collaboratively plan their operation, sharing target lists and attack strategies. Initial access was achieved via a drive-by compromise on a legitimate industry news website, where malicious JavaScript redirected users to a payload delivery server. Upon compromise, execution involved using systemctl to start a custom malicious service and employing Windows Management Instrumentation via WMIC to run remote tasks and execute scripts. For persistence, the adversary modified a Docker image to include a cron job for callback connections and wrote a VBScript file as a network logon script through registry modifications. Defense evasion techniques included using Compiled HTML Files to conceal payloads and deploying malware with a double file extension, such as 'report.pdf.exe', to trick users into execution. Discovery activities involved running a reconnaissance script that made Graph API queries for cloud service discovery to identify all registered service principals and executing 'vim-cmd vmsvc/get.summary' for virtual machine discovery to retrieve VM summaries. Additionally, the adversary used az ad user get-member-groups to enumerate cloud groups assigned to the compromised identity. Command and control was maintained with fallback channels, where the malware switched to a backup channel to request new tokens after failed connections to the primary C2 server. System logs from the victim environment showed increased network traffic to unknown IPs, but no immediate alerts were triggered due to encrypted payloads. The targeted organization, a mid-sized fintech company, reported unusual login attempts from foreign IP addresses, though initial investigations attributed this to routine user activity.",
    "tagged_text": "On March 15, 2024, SHADOWCRAWL initiated reconnaissance by using search engines [T1593.002] to identify vulnerable servers and researching victim infrastructure through compromised personal email accounts [T1586.002] to gather credentials and internal communications. The actors established a Dropbox Paper workspace [T1585.003] to collaboratively plan their operation, sharing target lists and attack strategies. Initial access was achieved via a drive-by compromise [T1189] on a legitimate industry news website, where malicious JavaScript redirected users to a payload delivery server. Upon compromise, execution involved using systemctl [T1569.003] to start a custom malicious service and employing Windows Management Instrumentation [T1047] via WMIC to run remote tasks and execute scripts. For persistence, the adversary modified a Docker image [T1525] to include a cron job for callback connections and wrote a VBScript file as a network logon script [T1037.003] through registry modifications. Defense evasion techniques included using Compiled HTML Files [T1218.001] to conceal payloads and deploying malware with a double file extension [T1036.007], such as 'report.pdf.exe', to trick users into execution. Discovery activities involved running a reconnaissance script that made Graph API queries for cloud service discovery [T1526] to identify all registered service principals and executing 'vim-cmd vmsvc/get.summary' for virtual machine discovery [T1673] to retrieve VM summaries. Additionally, the adversary used az ad user get-member-groups to enumerate cloud groups [T1069.003] assigned to the compromised identity. Command and control was maintained with fallback channels [T1008], where the malware switched to a backup channel to request new tokens after failed connections to the primary C2 server. System logs from the victim environment showed increased network traffic to unknown IPs, but no immediate alerts were triggered due to encrypted payloads. The targeted organization, a mid-sized fintech company, reported unusual login attempts from foreign IP addresses, though initial investigations attributed this to routine user activity.",
    "sentence_annotations": [
        {
            "sentence": "Initial access was achieved via a drive-by compromise on a legitimate industry news website, where malicious JavaScript redirected users to a payload delivery server.",
            "technique_id": "T1189",
            "technique_name": "Drive-by Compromise"
        },
        {
            "sentence": "003] to start a custom malicious service and employing Windows Management Instrumentation via WMIC to run remote tasks and execute scripts.",
            "technique_id": "T1047",
            "technique_name": "Windows Management Instrumentation"
        },
        {
            "sentence": "For persistence, the adversary modified a Docker image to include a cron job for callback connections and wrote a VBScript file as a network logon script [T1037.",
            "technique_id": "T1525",
            "technique_name": "Implant Internal Image"
        },
        {
            "sentence": "Discovery activities involved running a reconnaissance script that made Graph API queries for cloud service discovery to identify all registered service principals and executing 'vim-cmd vmsvc/get.",
            "technique_id": "T1526",
            "technique_name": "Cloud Service Discovery"
        },
        {
            "sentence": "summary' for virtual machine discovery to retrieve VM summaries.",
            "technique_id": "T1673",
            "technique_name": "Virtual Machine Discovery"
        },
        {
            "sentence": "Command and control was maintained with fallback channels, where the malware switched to a backup channel to request new tokens after failed connections to the primary C2 server.",
            "technique_id": "T1008",
            "technique_name": "Fallback Channels"
        }
    ],
    "llm_raw_response": {
        "title": "Joint Cybersecurity Advisory: Fictional APT Campaign 'SHADOWCRAWL' Targeting Cloud and On-Premises Infrastructure",
        "summary": "This advisory details a simulated campaign by a fictional threat actor group, designated SHADOWCRAWL, targeting organizations in the financial and technology sectors. The campaign involves initial reconnaissance through open-source intelligence, credential theft, and drive-by compromises, followed by execution via system services and WMI, persistence through Docker image modification and network logon scripts, defense evasion using CHM files and double extensions, discovery of cloud and virtual machine assets, and command and control with fallback mechanisms. The report is intended for blue team training to enhance detection and response capabilities.",
        "full_report_text": "On March 15, 2024, SHADOWCRAWL initiated reconnaissance by using search engines [T1593.002] to identify vulnerable servers and researching victim infrastructure through compromised personal email accounts [T1586.002] to gather credentials and internal communications. The actors established a Dropbox Paper workspace [T1585.003] to collaboratively plan their operation, sharing target lists and attack strategies. Initial access was achieved via a drive-by compromise [T1189] on a legitimate industry news website, where malicious JavaScript redirected users to a payload delivery server. Upon compromise, execution involved using systemctl [T1569.003] to start a custom malicious service and employing Windows Management Instrumentation [T1047] via WMIC to run remote tasks and execute scripts. For persistence, the adversary modified a Docker image [T1525] to include a cron job for callback connections and wrote a VBScript file as a network logon script [T1037.003] through registry modifications. Defense evasion techniques included using Compiled HTML Files [T1218.001] to conceal payloads and deploying malware with a double file extension [T1036.007], such as 'report.pdf.exe', to trick users into execution. Discovery activities involved running a reconnaissance script that made Graph API queries for cloud service discovery [T1526] to identify all registered service principals and executing 'vim-cmd vmsvc/get.summary' for virtual machine discovery [T1673] to retrieve VM summaries. Additionally, the adversary used az ad user get-member-groups to enumerate cloud groups [T1069.003] assigned to the compromised identity. Command and control was maintained with fallback channels [T1008], where the malware switched to a backup channel to request new tokens after failed connections to the primary C2 server. System logs from the victim environment showed increased network traffic to unknown IPs, but no immediate alerts were triggered due to encrypted payloads. The targeted organization, a mid-sized fintech company, reported unusual login attempts from foreign IP addresses, though initial investigations attributed this to routine user activity.",
        "techniques_used": [
            "T1593.002",
            "T1586.002",
            "T1585.003",
            "T1189",
            "T1569.003",
            "T1047",
            "T1525",
            "T1037.003",
            "T1218.001",
            "T1036.007",
            "T1526",
            "T1673",
            "T1069.003",
            "T1008"
        ]
    }
}