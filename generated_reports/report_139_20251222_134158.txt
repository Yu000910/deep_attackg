The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to inform blue teams of a fictional APT campaign designated 'USB Shadow'. This group targets organizations with mixed on-premises and cloud environments, primarily in the financial and technology sectors. Initial reconnaissance involved passive scanning of public-facing assets, but no specific TTPs were identified in this phase.

Initial Access: The actors conducted physical operations by dropping multiple USB Rubber Ducky devices in high-traffic areas such as parking lots and cafeterias, exploiting human curiosity to gain initial footholds [T1200]. Upon insertion, these devices simulated keystrokes to open a compromised website that displayed a fake 'System Scan Complete - Threats Found' alert, which downloaded and executed malware when users clicked 'Remove Threats' [T1204.004].

Execution and Persistence: Once inside the network, the adversary employed PowerShell scripts to abuse Azure RunCommand, deploying cryptocurrency mining software on virtual machines while simultaneously using 'net user helpdesk_user TempPass123 /add /domain /comment "IT Support Account"' to create a domain account for blending in with legitimate administrative activities [T1651, T1136.002]. To maintain persistence, they added their DLL path to HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages, ensuring continued access after reboots [T1547.002].

Defense Evasion and Privilege Escalation: The malware used run-only Applescripts, a compiled and stripped version of AppleScript, to remove human-readable indicators and evade detection on macOS systems [T1027.008]. Additionally, by modifying the kernel's system call table, the rootkit concealed its network connections and processes from standard monitoring tools [T1014]. The actors utilized InstallUtil.exe to bypass application control by running a malicious .NET binary masquerading as a legitimate installer, enabling execution without triggering security alerts [T1218.004].

Credential Access and Command and Control: For credential harvesting, the adversary used klist.exe to view Kerberos ticket expiration times and session keys, facilitating theft or forgery of tickets for lateral movement [T1558]. Network optimization was achieved through setsockopt to set SO_RCVBUF size, allowing the malware to handle large activation packets efficiently and maintain stable command and control channels [T1205.002].

Impact and Mitigation: The campaign resulted in resource depletion due to cryptocurrency mining and potential data exfiltration. Blue teams are advised to monitor for unusual USB device activity, implement application whitelisting, audit domain account creations, and inspect kernel modifications. Logs from the affected systems showed increased CPU usage on Azure VMs and anomalous network traffic patterns, but these were initially overlooked due to normal business operations.