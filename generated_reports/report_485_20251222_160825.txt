The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with training on a fictional APT campaign, 'ShadowWeave'. This report is based on a simulated scenario designed for educational purposes and does not reflect real-world events.

Background: ShadowWeave is a fictional threat actor believed to operate with state-sponsored objectives, focusing on espionage and financial gain. The group has been active since early 2023, targeting organizations in the banking, energy, and telecommunications sectors. In this scenario, the actor compromised a mid-sized financial firm, 'SecureBank Inc.', headquartered in New York, with subsidiaries across Europe. Initial detection occurred through anomalous network traffic logs from a perimeter firewall, showing unusual spikes in XMPP protocol usage during off-hours, which was later attributed to data exfiltration activities. SecureBank's IT team reported slow system performance and unauthorized remote desktop connections, prompting an internal investigation that uncovered signs of a broader intrusion.

Kill-Chain Analysis:
- **Initial Access**: ShadowWeave conducted reconnaissance by gathering IP addresses [T1590.005] and email addresses [T1589.002] from previous breaches to tailor watering hole attacks and spoofed emails, respectively. The actors then distributed malware via USB drives [T1091] to isolated environments, bypassing network defenses. For instance, on 2023-10-15, an employee at a European subsidiary inserted an infected USB, leading to the initial compromise.
- **Execution**: Upon execution, the malware employed Python scripts [T1059.006] to drop payloads and used Windows Management Instrumentation (WMI) [T1047] for persistence and lateral movement across the network. System logs from SecureBank's Windows servers showed multiple WMI events at 02:00 UTC on 2023-10-20, correlating with the deployment of additional tools.
- **Persistence and Defense Evasion**: To maintain stealth, the malware implemented mutual exclusion [T1480.002] by checking for existing instances and utilized debugger evasion [T1622] through API calls like NtQueryInformationProcess(). Additionally, the actors set up a rogue domain controller [T1207] to inject false authentication records, facilitating unauthorized access. Network scans revealed an unauthorized domain controller with IP 192.168.1.100, masquerading as a legitimate server.
- **Discovery and Lateral Movement**: ShadowWeave conducted cloud service discovery [T1526] to enumerate Azure AD resources and abused remote desktop software [T1219.002], such as AnyDesk, for lateral movement. The group also leveraged publish/subscribe protocols [T1071.005] like XMPP to blend malicious traffic with legitimate communications, making detection challenging. For example, on 2023-10-25, XMPP traffic increased by 300% during lunch hours, coinciding with data exfiltration attempts.
- **Exfiltration and Impact**: For data exfiltration, the actors used traffic duplication [T1020.001] via tools like ROMMONkit and exfiltrated data over other network mediums [T1011], such as open WiFi access points. They also implemented bandwidth hijacking [T1496.002] by establishing proxy services on compromised systems. Finally, the malware encrypted data for impact [T1486] using embedded keys, though in this scenario, no ransom was demanded, focusing instead on data theft. A sample exfiltration event occurred on 2023-10-30, where stolen financial records were uploaded to a rogue WiFi hotspot near SecureBank's office.

Irrelevant Information: SecureBank Inc. was founded in 1995 and has over 5,000 employees globally. The company uses a hybrid cloud infrastructure with Microsoft Azure and on-premises servers. During the investigation, unrelated log entries were found, including routine backup failures and user login errors from legacy systems, which did not correlate with the attack timeline. The IT team initially suspected a DDoS attack due to network slowdowns, but further analysis revealed the true nature of the compromise.

Mitigation Recommendations: Blue teams should monitor for IoCs such as unusual XMPP traffic, unauthorized domain controllers, and Python script executions. Implement network segmentation, disable unnecessary WMI services, and enforce strict USB usage policies. Regular audits of cloud services and remote access tools are advised to detect anomalies early.