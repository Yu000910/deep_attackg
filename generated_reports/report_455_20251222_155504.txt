The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional attack scenario based on observed techniques. In this simulated campaign, the threat actor 'CloudShroud' targets organizations with mixed on-premises and cloud environments, exploiting misconfigurations and using advanced obfuscation methods.

Initial Access: The campaign began with a phishing email [T1566] containing a malicious Word document that exploited a known vulnerability when opened, leading to initial compromise. System logs from the victim's email server showed increased traffic from an IP address in a non-standard region, but this was later determined to be unrelated noise.

Execution: Upon execution, the malware employed rundll32 [T1218.011] with an export named 'init' to install a backdoor, while simultaneously using PowerShell to download additional payloads from a cloud storage service. The actors then leveraged serverless execution [T1648] by compromising a Lambda function to run unauthorized shell commands in the cloud environment, evading traditional endpoint detection. Background checks revealed the organization had recently migrated to a multi-cloud setup, with some legacy systems still in use.

Persistence and Defense Evasion: To maintain persistence and avoid detection, the actors utilized serverless infrastructure [T1584.007] such as Cloudflare Workers to obfuscate communication with compromised systems through encrypted channels, and they created scripts to automatically provision cloud instances in unused or unsupported cloud regions [T1535]. Network logs indicated sporadic DNS queries to benign domains, which were not tagged as malicious.

Lateral Movement: For lateral movement within the on-premises network, the actors employed Pass the Ticket attacks [T1550.003] using Kerberos tickets, while also searching for data on network shared drives [T1039] with commands like 'where /r \\fileshare\projects *.xlsx' to locate Excel spreadsheets containing project data. Internal security audits noted several outdated user accounts, but this was unrelated to the attack.

Collection and Exfiltration: The threat actor staged data [T1074] by using bash scripts to aggregate network configuration files into a staging location, and they extracted system configuration settings from the Windows Registry [T1602] for exfiltration. To facilitate data transfer, they implemented protocol tunneling [T1572] using tools like Iox and NPS proxy to create multiple connections through a single tunnel, and they exfiltrated data over other network mediums [T1011] by connecting to an unauthorized WiFi network. Additionally, they used exfiltration over unencrypted non-C2 protocols [T1048.003] by encoding victim data and prepending it as subdomains in DNS lookups to attacker-controlled domains. System performance metrics showed a slight increase in CPU usage during these activities, but it was within normal operational thresholds.