The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with a realistic training scenario based on fictional APT activity. This report outlines the TTPs of 'ShadowMirage,' a simulated threat actor targeting organizations in the energy and manufacturing sectors. Initial analysis indicates the campaign began in early 2024, with actors exploiting publicly available information and weak web security to gain initial footholds.

**Reconnaissance Phase:**
The actors likely conducted extensive reconnaissance to identify potential targets and vulnerabilities. Using specialized query syntax on search engines [T1593.002], they searched for exposed backup files with queries like 'intitle:"index of" "target company" backup,' uncovering sensitive data on misconfigured web servers. Additionally, they queried public WHOIS databases to discover organizational subsidiaries and their network trust dependencies [T1590.003], mapping out potential entry points through less-secure partner networks. System logs from target firewalls showed increased scanning activity from IP addresses associated with known proxy services, though this was not directly linked to the initial compromise.

**Initial Access and Execution:**
To gain initial access, the actors employed a drive-by compromise [T1189] by infecting a legitimate industry news website frequented by employees, turning it into a watering hole that delivered malicious JavaScript payloads when visited. Upon execution, the payload leveraged native API calls [T1106] to bypass security software and inject code into legitimate processes, such as svchost.exe, while simultaneously modifying registry keys to establish persistence. For persistence on macOS systems, the actors modified com.apple.loginwindow.UUID.plist to re-open applications [T1547.007], ensuring network scanning utilities executed automatically upon user authentication, though this was observed in a limited test environment only.

**Credential Access and Discovery:**
After establishing a foothold, the actors focused on credential harvesting and system discovery. A script was deployed to locate and exfiltrate the LastPass vault file stored in the browser's local application data directory [T1555.005], extracting stored passwords for further lateral movement. To understand the local environment, a PowerShell script ran 'net localgroup administrators' [T1069.001] to discover users with administrative rights on the target machine, while also using tools like BloodHound to collect local admin information via Group Policy discovery [T1615], mapping out privilege escalation paths across the domain. Network traffic analysis revealed anomalous SMB connections during off-hours, but these were unrelated to the primary attack chain.

**Command and Control (C2):**
For C2 communication, the actors implemented sophisticated methods to evade detection. They used a dead drop resolver [T1102.001] by reading C2 instructions from publicly accessible Google Documents, with malware configured to parse specific fields for commands. Additionally, they established one-way communication [T1102.003] by downloading resources from Web services like Twitter and GitHub, where binaries contained algorithms to generate different Twitter handles daily for instruction retrieval, mimicking HAMMERTOSS TTPs. To avoid pattern detection, the malware employed scheduled transfers [T1029], sleeping for randomized intervals between data exfiltration attempts, though some network logs showed failed connections due to firewall rules blocking unknown domains. The target company, 'Global Energy Solutions,' reported no actual data loss, but this scenario highlights potential weaknesses in their security posture.

**Mitigation Recommendations (Fictional):**
Blue teams should monitor for unusual search engine queries targeting their organization, secure web servers against misconfigurations, implement application whitelisting to block unauthorized native API usage, audit persistence mechanisms on all operating systems, enforce strong password manager security policies, regularly review local group memberships and GPO settings, and deploy network monitoring tools to detect anomalous C2 traffic patterns. This advisory serves as a training exercise to enhance defensive capabilities against similar real-world threats.