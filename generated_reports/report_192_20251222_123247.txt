The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training insights into a fictional APT campaign, 'Dragonfly Echo,' which mimics real-world adversary behaviors. This campaign targets organizations in the energy and manufacturing sectors, with observed activity beginning in early 2024. Background analysis indicates the group leverages known vulnerabilities in common enterprise software, as detailed in open-source threat intelligence reports. Dragonfly Echo actors likely conduct initial reconnaissance [T1589] to identify vulnerable systems, though this phase is not directly observed in the current scenario.

Initial Access: The campaign commenced with the exploitation of a public-facing Citrix ADC server [T1190], where actors injected malicious SQL queries to bypass authentication and gain unauthorized access to the network. This was facilitated by exploiting CVE-2019-19781, a known vulnerability in Citrix appliances that allows remote code execution. System logs from the targeted server show anomalous login attempts from IP addresses associated with known malicious infrastructure, but these were not flagged by existing security controls due to misconfigured alert thresholds.

Execution and Persistence: Upon gaining access, the actors employed PowerShell [T1059.001] to download a malicious payload from a compromised external server [T1105] and configured schtasks.exe to create a scheduled task [T1053] that runs weekly, ensuring persistent execution of the payload even after system reboots. The payload, named 'malicious.exe,' was disguised as a legitimate system update and stored in a hidden directory, evading initial antivirus scans. Additionally, the actors modified registry keys [T1112] to disable security features and maintain stealth.

Discovery and Command and Control: After establishing persistence, the actors conducted peripheral device discovery [T1120] using custom scripts to enumerate attached USB devices, collecting details such as device instance IDs and drive geometry to identify potential data exfiltration points. For command and control (C2), they implemented multi-stage channels [T1104] by first retrieving an encoded IP address from a Microsoft TechNet Web portal, then communicating separately with that IP address using asymmetric cryptography [T1573.002] encapsulated in Tor traffic with multiple layers of encryption. This allowed the actors to update the C2 server dynamically if discovered, maintaining control over compromised machines. Network traffic analysis revealed encrypted packets to non-standard ports, but these were initially dismissed as benign due to lack of decryption capabilities.

Impact: In the final stage, the actors executed a service stop [T1489] to halt SQL services on critical databases, ensuring they could encrypt the data without interference. This disruption caused temporary operational downtime, though no actual data loss occurred in this training scenario. Incident response teams noted failed login attempts to administrative consoles during this phase, but these were attributed to user error in initial assessments. The campaign highlights the need for enhanced monitoring of scheduled tasks, encrypted traffic, and service disruptions in blue team defenses.