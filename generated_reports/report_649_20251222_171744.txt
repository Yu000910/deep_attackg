The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training insights into the fictional APT group 'ShadowGale', which conducted a simulated attack against 'EnergyGrid Corp.', a mid-sized utility company with operations across the southwestern United States. EnergyGrid Corp. reported anomalous network activity starting in early 2024, prompting an internal investigation that revealed a multi-stage intrusion. The company's IT infrastructure includes a mix of on-premises servers, cloud-based services, and industrial control systems, with standard logging enabled but limited advanced threat detection tools in place at the time of the incident.

Initial reconnaissance involved the adversary using nmap with OS detection flags to gather network topology information from the target environment [T1590.004], which revealed vulnerable web servers and internal IP ranges. Following this, the actors injected JavaScript code into a compromised news website to display fake security alerts that prompted malware installation [T1608.005], leading to initial access via drive-by downloads. Once inside, the malware exploited a compromised ISP channel to redirect user traffic through a malicious proxy [T1659], enabling command and control communications while blending with legitimate traffic.

Execution and persistence were achieved through multiple vectors: the threat actor ran 'systemctl start network-sniffer.service' to activate packet capture [T1569.003] and simultaneously executed esxcli commands to enumerate all running virtual machines on the hypervisor [T1059.012], facilitating lateral movement. To maintain access, the attacker appended their public SSH key to the authorized_keys file [T1098.004] and configured a script to modify com.apple.loginwindow.UUID.plist, triggering payload execution upon login [T1547.007]. Additionally, attackers manipulated Entra ID conditional access policies to remove session timeout limitations for persistent access [T1556.009], while using ExchangePowerShell to delete suspicious email logs from the mail server [T1070.008] to cover their tracks.

Discovery and exfiltration activities included the adversary using `netstat -ano` on compromised hosts to enumerate network connections [T1049] and copying 'backdoor.exe' to removable media for later execution on isolated systems [T1091]. Command and control was obfuscated by leveraging XMPP's federated architecture to blend their traffic with legitimate instant messaging communications [T1071.005]. Logs from EnergyGrid Corp.'s firewall showed increased outbound traffic to unknown IP addresses, but no alerts were triggered due to misconfigured thresholds. The company's incident response team eventually detected the activity during a routine audit, leading to containment and remediation efforts.