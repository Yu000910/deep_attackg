The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional advanced persistent threat (APT) campaign. Crimson Serpent, a suspected state-sponsored group, has been observed targeting mid-sized financial firms in North America since early 2024. Initial analysis suggests the campaign aims to steal proprietary trading algorithms and customer financial records. System logs from a compromised server, 'FIN-SRV-02', show unusual network traffic spikes at 03:00 UTC on April 15, 2024, but this was initially attributed to scheduled maintenance. The company, 'SecureBank Inc.', reported no prior breaches in its annual security audit last quarter.

In the reconnaissance phase, the actors likely conducted searches on domain analysis websites to gather information about the victim's web infrastructure [T1596.003] while simultaneously querying WHOIS records to identify domain expiration dates and potential takeover opportunities [T1596.002]. They also searched Facebook for employees who recently joined the target company [T1593] to identify potential social engineering targets. Background: SecureBank Inc. operates primarily in the retail banking sector with 500 employees.

For initial access and execution, the malware connected to an unprotected wireless network to exfiltrate collected data [T1669] and employed Lua commands to enumerate system information and network configuration [T1059.011]. During installation, it used installer packages with postinstall scripts to extract a hidden plist from the application's /Resources folder and execute it as a Launch Daemon with elevated permissions [T1546.016]. The actors then used VNC tools, including UltraVNC, to remotely interact with compromised hosts [T1021.005] and leveraged remote shares to move laterally through victim networks [T1021.002]. For command and control, the malicious code called setsockopt with IPPROTO_IP options to configure socket behavior for packet-triggered activation [T1205.002] and registered a DNS A record for 'cdn-api.services' to maintain persistent communication via fast flux DNS [T1568.001]. Log entries from the firewall show blocked attempts on port 445, but these were logged as false positives during routine scans.