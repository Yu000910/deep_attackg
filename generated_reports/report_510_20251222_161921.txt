The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with training on a fictional advanced persistent threat (APT) campaign designated 'ShadowHawk'. This report is based on a simulated attack scenario designed to educate defenders on identifying and mitigating complex threats in cloud and on-premises environments.

Initial Access: The actors likely conduct reconnaissance [T1589] to identify target organizations, followed by a drive-by compromise [T1189] where malicious JavaScript was injected into a legitimate ad network, causing browser.exe to execute unwanted processes that initiated the attack chain. This activity was observed in logs showing unusual network traffic from compromised endpoints, though no actual data breach occurred in this training scenario.

Execution and Persistence: Upon gaining access, the adversary employed Azure PowerShell [T1059.009] to actively execute 'Get-AzVM' commands for enumerating virtual machines while simultaneously using process hollowing [T1055.012] to inject malicious code into the svchost.exe process, evading detection by masquerading as legitimate system activity. System logs indicated anomalous PowerShell executions during off-hours, but these were part of the simulated attack.

Discovery: The campaign then focused on discovery techniques, leveraging Group Policy discovery [T1615] to enumerate domain policies and permission groups discovery [T1069] to identify members of privileged groups using commands like 'net group /domain', all while conducting SNMP walks [T1602.001] to gather device inventory data from network infrastructure. These actions were logged in standard system events, though no real credentials were compromised.

Collection and Exfiltration: For data collection, the actors extracted files from the local system [T1005] using tools like ZxShell and implemented web portal capture [T1056.003] by redirecting login codes to controlled websites, mimicking the Triton attack, while employing application layer protocols [T1071] such as IRC for command and control communication to exfiltrate stolen data. Network monitoring tools flagged unusual outbound traffic, but this was contained within the training environment.

This advisory serves as an educational tool to highlight the importance of monitoring for these techniques in real-world scenarios. Organizations are encouraged to review their security postures and implement defensive measures outlined in the MITRE ATT&CK framework.