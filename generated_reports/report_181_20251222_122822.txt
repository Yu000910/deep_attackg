The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to inform blue teams about the fictional APT group 'ShadowVendor', which has been observed conducting a sophisticated campaign against retail sectors since early 2024. This report is based on simulated incident response data from a fictional retail company, 'GlobalMart Inc.', which reported anomalous network activity and credential theft incidents. Background: GlobalMart Inc. operates a global e-commerce platform with servers hosted in AWS and on-premises data centers, utilizing Windows Active Directory for user management. Initial logs from their SIEM showed increased DNS query volumes, but no immediate alerts were triggered.

In the initial access phase, the actors likely conducted reconnaissance by performing iterative DNS queries to enumerate all nameservers authoritative for the target's primary domain [T1596.001], which was detected in passive network logs but initially dismissed as benign scanning activity. Concurrently, they exploited supply chain vulnerabilities by distributing modified Teensy USB devices through compromised hardware suppliers to infect consumer electronics [T1195.003], as reported in fictional supply chain audits from third-party vendors. These devices were used to gain initial footholds in corporate networks.

Upon execution, the adversary employed a command and scripting interpreter [T1059] via 'bash -c' to execute arbitrary commands received from a command and control server while simultaneously dropping a credential-harvesting DLL into the Windows temp folder to capture user passwords [T1556.002]. This was followed by issuing 'net accounts /domain' to check if password history is enforced in the domain [T1201] and listing running processes through the use of `tasklist` to identify security software [T1057]. System logs from affected endpoints showed unusual process creation events, but these were not correlated with the DNS anomalies.

For persistence and lateral movement, the malware utilized Distributed Component Object Model (DCOM) to remotely trigger malicious macros in Microsoft Access databases [T1021.003], and the adversary exploited a vulnerable ISP infrastructure to inject malicious advertisements into web traffic, redirecting users to phishing sites [T1659]. Additionally, using SSH port forwarding, they created an encrypted tunnel to bypass network segmentation controls and exfiltrate data [T1572]. Network traffic analysis revealed encrypted outbound connections on non-standard ports, but these were initially attributed to legitimate administrative tasks. The campaign highlights the importance of monitoring for protocol tunneling and content injection in defensive strategies.