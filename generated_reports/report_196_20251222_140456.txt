On October 15, 2023, security teams at a fictional financial institution, 'SecureBank Inc.', detected anomalous activity originating from a customer-facing web portal. The actors likely conducted reconnaissance [T1589] to identify vulnerabilities in the bank's online services. Initial access was achieved by injecting malicious JavaScript code into the legitimate banking website, which displayed a fake session timeout warning to capture user login credentials [T1608.005]. This allowed the adversaries to compromise several user accounts and gain a foothold in the network. System logs from the web server showed unusual traffic spikes, but initial investigations attributed this to a routine maintenance error, delaying detection.

Once inside, the actors deployed custom-built malware, similar to DCSrv and PyDCrypt used by Moses Staff, designed to encrypt files and exfiltrate data [T1587.001]. Execution involved using a malicious Docker image that contained instructions to install a remote access trojan during the build process, enabling covert command and control [T1204.003]. The malware then propagated laterally across the network by exploiting default Administrator account credentials, allowing it to move undetected through shared systems [T1078.001]. Network monitoring tools flagged multiple failed login attempts, but these were initially dismissed as part of a penetration testing exercise.

To maintain persistence, the malware established a systemd timer that executed data exfiltration scripts every six hours, ensuring continuous operation even after reboots [T1053.006]. Concurrently, the actors conducted network share discovery using APIs like WNetOpenEnumA to map accessible resources and identify sensitive data stores [T1135]. They also ran commands such as 'net accounts /domain' to gather information about domain password enforcement rules, aiding in further credential theft [T1201]. Background checks revealed that SecureBank Inc. had recently migrated some services to AWS, but this was considered unrelated at the time.

For data exfiltration, the actors employed protocol tunneling by abusing DNS-over-HTTPS (DoH) protocols to conceal DNS queries from security appliances, maintaining stealthy communication channels [T1572]. Additionally, they programmatically abused AWS SNS to send high-frequency notifications across multiple regions, causing regional service degradation and distracting incident response teams [T1496.004]. The campaign culminated in significant data loss and operational disruption, with recovery efforts hampered by the actors' use of encrypted payloads and cloud-based obfuscation. Post-incident analysis highlighted gaps in monitoring for default account usage and cloud service misconfigurations.