The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to highlight tactics, techniques, and procedures (TTPs) associated with the fictional threat actor 'ShadowWeaver.' This campaign, observed between January and March 2024, demonstrates a sophisticated multi-stage attack leveraging both cloud and on-premises environments. Initial analysis suggests the actors likely conduct reconnaissance [T1589] through open-source intelligence gathering, though specific indicators are not detailed in this report.

In the initial access phase, the actors compromised a GitHub organization [T1584.006] to inject malicious code into popular open-source libraries, which was then distributed to victim systems via automated updates. Concurrently, they deployed adversary-in-the-middle DNS servers [T1583.002] to impersonate legitimate services, such as corporate login portals, and used content injection [T1659] through a compromised ISP channel to redirect user traffic through a malicious proxy, facilitating credential capture. For example, logs from a victim network show DNS queries to 'login.corp.example.com' resolving to 192.0.2.1, an unauthorized IP, with subsequent HTTP requests being intercepted.

Upon execution, the adversary employed PowerShell [T1059.001] to actively download malicious payloads from command-and-control (C2) servers while simultaneously modifying registry keys to establish persistence. They leveraged compromised cloud accounts [T1078.004], using stolen credentials from victim users to authenticate to Azure tenants and access sensitive resources, such as storage blobs containing financial data. Internal telemetry indicates multiple failed login attempts from IP 203.0.113.5, followed by successful access using valid credentials.

For persistence and privilege escalation, the actors modified the authentication process [T1556] by copying the SAM database file from a Volume Shadow Copy and cracking its hashes offline to extract credentials. They also altered time providers [T1547.003] via a registry modification to HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\, adding a new malicious entry, and configured AppInit DLLs [T1546.010] using 'reg add' to ensure execution upon system login. Additionally, they performed keylogging [T1056.001] to capture user inputs, including passwords and sensitive data, and conducted device driver discovery [T1652] using the Windows API function EnumDeviceDrivers() to programmatically retrieve a list of all loaded device drivers for evasion purposes.

In the lateral movement phase, the actors spread via SMB/Windows Admin Shares [T1021.002], encrypting files on different hosts and potentially compromising the entire network. They employed external proxies [T1090.002] to encrypt and redirect C2 traffic, making detection more difficult. For instance, network traffic analysis revealed encrypted connections to 198.51.100.10 via port 443, with payloads masquerading as legitimate HTTPS traffic. The company background includes a mid-sized fintech firm with hybrid infrastructure, but this detail is not directly related to the attack techniques. Recommendations include monitoring for unusual PowerShell scripts, enforcing strong authentication controls, and reviewing DNS configurations for anomalies.