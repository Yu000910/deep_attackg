The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide insights into a fictional APT campaign for educational purposes. In this scenario, 'ShadowHook' actors targeted a mid-sized financial services company, 'SecureBank Corp.', headquartered in New York with branches across the U.S. The company's IT infrastructure includes Windows and macOS endpoints, Linux servers, and cloud-based SharePoint for document management. Initial detection occurred on 2023-10-15 when anomalous DNS queries were flagged by the SIEM, but prior logs from September showed increased reconnaissance activity.

During the reconnaissance phase, the actors gathered passive DNS information by analyzing historical DNS query logs from public sources to map SecureBank's external network footprint [T1590.002]. This included identifying subdomains like 'mail.securebank.com' and 'vpn.securebank.com', which were later used in phishing campaigns. System logs from the firewall showed no direct breaches at this stage, but the actors likely correlated this data with social media profiles of employees.

For initial access, the adversary conducted spearphishing voice calls posing as IT support to trick a finance department employee into clicking a malicious link in a follow-up email, which automatically downloaded and executed a remote access tool when opened [T1566.004]. The email originated from a spoofed domain resembling SecureBank's internal address, and the link pointed to a compromised server hosting the payload. Upon execution, the malware exploited an Oracle Java vulnerability (CVE-2013-2465) on the employee's macOS system to gain code execution and deploy a backdoor [T1203].

To establish persistence, the malware wrote a persistent AppleScript to the user's LaunchAgents folder that would run on every login, ensuring the backdoor remained active even after reboots [T1059.002]. Additionally, the actors modified a binary by adding the setuid flag to facilitate future privilege escalation without requiring user interaction [T1548.001]. System logs from the affected endpoint showed repeated execution of the AppleScript at login times, but these were initially overlooked as benign user activity.

For credential harvesting, the adversary used reg query commands to access HKEY_LOCAL_MACHINE\SECURITY and extract LSA secrets, obtaining hashed credentials for domain accounts [T1003.004]. This allowed them to move laterally within the network by exploiting SSH to gain remote control of a compromised Linux server used for internal applications [T1021.004]. The server's logs indicated multiple failed login attempts prior to success, suggesting brute-force attempts that were not immediately blocked.

In parallel, the actors set up an evil twin Wi-Fi access point in a public caf√© near SecureBank's office to passively monitor all wireless communications from employees using company devices off-site [T1557.004]. This enabled interception of unencrypted traffic, though most sensitive data was encrypted via VPN. For data exfiltration, they abused compromised credentials to access and download files from SharePoint, targeting financial reports and customer data stored in cloud repositories [T1213.002]. The exfiltration occurred over several days, with data transferred to external servers via encrypted channels.

To evade detection during the investigation phase, the threat actor de-registered the DNS A record associated with their command-and-control server, making it difficult to attribute the activity and hindering forensic analysis [T1568.001]. This was observed when DNS queries from compromised systems suddenly failed to resolve, prompting incident responders to review historical DNS logs. The company's incident response team, after containing the breach, noted that regular patching of Java vulnerabilities could have mitigated the initial exploitation, and recommended enhanced monitoring for anomalous SSH and SharePoint access patterns.