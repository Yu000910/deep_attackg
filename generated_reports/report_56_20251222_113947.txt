The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with training on a simulated advanced persistent threat (APT) campaign. The actors, designated as 'Cobalt Serpent,' have been observed targeting organizations with weak software development security practices. Initial analysis indicates the campaign began in early 2024, with no real-world impact reported, as this is a training scenario.

Attack Scenario:
The actors likely conducted initial reconnaissance by scanning public repositories for vulnerable dependencies, though specific logs from GitHub show normal traffic patterns. They then compromised a software dependency by injecting malicious code into an update script, update.ps1, which was distributed through a third-party package manager to steal browser cookies and session data [T1195.001]. Concurrently, the threat actors leveraged malicious Docker images hosted on a public registry, relying on users to download and execute these images to deploy backdoors in containerized environments [T1204.003]. Once initial access was achieved, the actors established persistence by setting up a trap mechanism that used SIGALRM signals to trigger execution of a malicious binary upon alarm events [T1546.005]. For further evasion, the backdoor employed asynchronous procedure calls (APC) to inject code into svchost.exe threads, calling OpenThread to find suitable targets [T1055.004], while implementing debugger evasion techniques such as calling NtQueryInformationProcess with InfoClass=7 to check for ProcessDebugPort and avoid analysis [T1622].

In the post-exploitation phase, the actors conducted discovery activities using a PowerShell script to enumerate all Group Policy Objects in the Active Directory domain [T1615] and utilized ROADTools to enumerate Azure AD users for cloud account reconnaissance [T1087.004]. System information discovery was performed by identifying the computer name of compromised hosts [T1082], and the attackers leveraged AWS Systems Manager Run Command to deploy backdoors across all managed instances [T1072]. To obscure their infrastructure, APT29-style tactics were mimicked by using compromised residential endpoints within the same ISP IP range as proxies to hide command and control (C2) traffic sources [T1665]. Finally, exfiltration was attempted over Bluetooth by exploiting pairing protocol weaknesses to transfer stolen credentials to a nearby device [T1011.001]. Logs from affected systems show increased network traffic but no actual data loss, as this is part of the training exercise. The campaign highlights the need for robust supply chain security and monitoring of cloud management tools.