The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional threat actor designated as 'Grimoire', which has been observed targeting energy and manufacturing sectors in a simulated environment. This report is based on a training scenario designed to enhance blue team detection capabilities.

**Initial Access:** The actors likely conducted reconnaissance through social media profiling and network scanning, though no specific techniques are tagged here. Initial compromise was achieved by planting malicious USB drives in target facilities, leveraging social engineering to trick employees into inserting them, which allowed the malware to replicate across systems [T1091]. Logs from endpoint detection systems showed unusual USB activity on multiple workstations, but this was initially dismissed as user error.

**Execution:** Upon insertion, the USB drives executed a JavaScript-based payload [T1059.007] that downloaded additional components from a command-and-control (C2) server. The malware then used stolen domain credentials [T1078.002] to move laterally within the network, accessing administrative shares and systems. System administrators reported failed login attempts on domain controllers, but these were attributed to password expiration policies.

**Persistence:** To maintain access, the actors installed a custom kernel module [T1547.006] that provided backdoor functionality, allowing them to bypass security controls and remain undetected. This module was signed with a stolen certificate, making it appear legitimate to antivirus software. Network traffic analysis revealed sporadic connections to external IPs, but these were masked as legitimate updates.

**Credential Access:** The malware implemented a web portal capture mechanism [T1056.003] by redirecting login pages to attacker-controlled sites, harvesting credentials as users attempted to change passwords. Additionally, it performed Wi-Fi discovery [T1016.002] to gather wireless network credentials from infected machines, using commands like 'netsh wlan show profile key=clear'. Internal audits noted discrepancies in credential databases, but no immediate action was taken.

**Discovery:** The actors conducted file and directory discovery [T1083] to enumerate sensitive documents and configuration files, and performed network device configuration dumps [T1602.002] via SNMP GET requests to extract router and switch settings. They also employed user activity-based checks [T1497.002] by scanning process listings for analysis tools like 'malware.exe' to evade detection in sandbox environments. Logs from file servers showed unauthorized access to engineering diagrams, but this was logged as routine backup activity.

**Exfiltration:** Data was exfiltrated using a proxy [T1090] to obfuscate traffic, with communications encoded using a non-standard encoding scheme [T1132.002] based on modified Base64 with custom character substitutions. The exfiltration occurred during off-peak hours to blend with normal network traffic. Incident response teams later identified anomalous outbound flows to unknown domains, but initial investigations focused on misconfigured firewalls.

**Mitigation Recommendations:** Organizations should implement strict USB usage policies, monitor for unusual kernel module loads, and use multi-factor authentication to protect domain accounts. Regular audits of network device configurations and encryption of sensitive data in transit are also advised. This scenario highlights the importance of correlating disparate logs to detect sophisticated attack chains.