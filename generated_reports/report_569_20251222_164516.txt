### Attack Scenario: ShadowWeaver Campaign

**Background:** ShadowWeaver is a fictional APT group with suspected ties to state-sponsored actors, focusing on energy and financial sectors. Initial detection occurred at 'Global Utilities Inc.', where anomalous network traffic and system slowdowns were reported. Logs showed unusual DLL loads and unauthorized SMTP communications to external IPs in Eastern Europe.

**Kill-Chain Analysis:**

1. **Initial Access & Execution:** The actors likely conducted reconnaissance [T1589] to identify targets, then compromised the software supply chain by injecting a backdoor into a third-party library, malicious_dependency.dll, used by multiple applications across the network [T1195]. Upon execution, the malware, codenamed 'VERMIN', was initially packed [T1027.002] to evade detection and utilized dlopen to load a shared object containing backdoor functionality [T1129].

2. **Persistence & Privilege Escalation:** To maintain access, ShadowWeaver developed unique malware, including tools like 'Mafalda' for mouse event logging [T1056] and 'SoreFang' to enumerate domain groups by executing net.exe group /domain [T1069.002]. They staged reconnaissance tools on a public GitHub gist to avoid detection [T1608] and employed path interception by writing a malicious DLL named 'netapi32.dll' into the system32 folder to hijack legitimate API calls [T1574.008].

3. **Defense Evasion & Credential Access:** The group deployed an evil twin captive portal that mimicked the corporate login page to steal credentials [T1557.004]. Using cmd.exe, they gathered network configuration data into a compressed archive for staging [T1074] and employed cmd.exe commands to collect process lists and network connections into a central file for remote data staging [T1074.002]. Additionally, 'Meteor' malware was used to disconnect all network adapters on compromised hosts using PowerShell commands to disrupt monitoring [T1489].

4. **Exfiltration:** ShadowWeaver leveraged SMTP to transmit harvested browser cookies to an external email server [T1071.003] and used tools like 'USBStealer' to exfiltrate collected files via removable media from air-gapped victims [T1052.001]. Network logs at Global Utilities Inc. showed spikes in outbound traffic to suspicious domains, though no actual data loss was confirmed in this training scenario.

**Recommendations for Blue Teams:** Monitor for unusual DLL loads, unauthorized SMTP traffic, and GitHub gist accesses. Implement application whitelisting and network segmentation to limit lateral movement. Regularly audit third-party software and conduct phishing simulations to train users against credential theft.

**Note:** This is a fictional report for educational purposes; any resemblance to real incidents is coincidental.