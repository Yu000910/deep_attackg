The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide blue teams with a fictional, educational scenario based on the threat actor 'ShadowMiner'. This campaign is designed for training purposes to enhance defensive capabilities against advanced persistent threats.

**Attack Narrative**
ShadowMiner likely conducts initial reconnaissance by scanning public databases like FOFA and Shodan [T1596.005] to identify exposed victim infrastructure, including web servers and IoT devices. Concurrently, the actors gather hardware details from Windows event logs using wevtutil.exe [T1592.001] to profile target systems. On 2023-10-15, system logs from a fictional energy company, 'PowerGrid Inc.', showed unusual network traffic from IP 192.168.1.100, though this was later determined to be a false positive from a routine maintenance script.

For initial access, the adversary sent a phishing email with an attached invoice document containing malicious macros [T1566], which, when opened, executed a PowerShell script to download additional payloads. The malware then employed Unix shell scripts [T1059.004] to execute commands on compromised Linux servers, while modifying the pam_unix.so module to log authentication attempts to a hidden file [T1556.003]. In one instance, a backup server at PowerGrid Inc. experienced a temporary slowdown due to a misconfigured cron job, unrelated to the attack.

For persistence and lateral movement, the actor modified registry keys in HKLM\SYSTEM\CurrentControlSet\Control\Print\Environments\Windows x64\Print Processors to point to a malicious DLL [T1547.012] and used Windows Remote Management (WinRM) [T1021.006] to query system information remotely. Additionally, the malware executed 'netsh wlan show profile key=clear' to gather Wi-Fi credentials [T1016.002] and listed keyboard layouts using GetKeyboardLayoutList API to check against a hardcoded language list, sleeping if a match was found [T1614.001]. Network logs indicated intermittent connection drops on port 443, but this was attributed to an overloaded firewall rule, not malicious activity.

For data collection and exfiltration, the threat actor utilized Microsoft Dynamics 365 APIs to gather customer billing information [T1213.004] and downloaded various modules, including IcedID and NetSupport Manager RAT-based malware, to the compromised host [T1105]. To obscure their infrastructure, ShadowMiner used compromised residential endpoints within the same ISP IP range as proxies [T1665], making C2 traffic appear legitimate. A routine audit at PowerGrid Inc. flagged an unauthorized access attempt to the CRM system, though it was later traced to a developer testing a new integration.

For impact, the malware exploited a slowloris vulnerability in nginx web servers to exhaust connection pools [T1499] and hijacked the victim's GPU resources to mine Ethereum through a compromised graphics driver [T1496], causing significant performance degradation. Incident responders noted that the system's CPU usage spiked to 95% during the mining activity, but initial reports mistakenly blamed a faulty cooling system.

**Recommendations**
Blue teams should implement network segmentation, monitor for unusual WinRM and database scanning activities, and educate users on phishing awareness. Regular patching of web servers and review of authentication logs are advised to mitigate these techniques.