Background: The fictional victim organization, 'GlobalTech Solutions', operates a hybrid infrastructure with AWS cloud services and on-premises Linux servers, handling sensitive financial data. Initial logs from their SIEM showed anomalous SSH connections from IP addresses associated with known malicious actors, but these were initially dismissed as false positives due to high network traffic during a system update.

Attack Narrative: The actors likely conduct reconnaissance to identify vulnerable external services [T1589]. They then achieved initial access by exploiting weak SSH credentials on an external-facing server [T1133], which was misconfigured without multi-factor authentication. Upon access, the adversary employed PowerShell to execute a script that used the `WshShortcut` COM object [T1559.001] to create a malicious .lnk file in the Windows startup folder, ensuring persistence upon reboot. Concurrently, they ran discovery commands, using a PowerShell script to call GetLocaleInfoW with the LOCALE_SNAME parameter [T1614] to identify the system's language and country settings [T1614.001], and executed 'kubectl get services' [T1613] to discover exposed services in the Kubernetes environment, indicating intent to target containerized assets.

To establish command and control (C2), the actors abused cloud infrastructure by setting up an AWS Lambda function [T1584.007] to create a serverless redirect service for stolen credentials, while also provisioning a virtual private server (VPS) [T1584.003] to host untraceable C2 channels. They configured CLI commands on the network gateway to reduce the encryption key length [T1600.001], weakening security for subsequent tunneling activities. The adversary then used SSH port forwarding [T1572] to create an encrypted tunnel through the corporate proxy, evading network monitoring, and communicated with the C2 server over HTTP [T1071.001] for coordination.

For data exfiltration and manipulation, the actors established a Dropbox account with two-factor authentication disabled [T1585.003] to maintain persistent access, and used the C2 channel to exfiltrate files over SMTP and DNS [T1041]. They also employed DYEPACK.FOX [T1565.003] to manipulate PDF data at runtime, removing traces of fraudulent transactions from displayed data, and used a custom secure delete function to overwrite file contents with data from heap memory [T1485], ensuring data destruction to hinder forensic analysis. Post-incident, system logs revealed failed login attempts from the VPS IP, but these were correlated too late due to noise from legitimate user activity.