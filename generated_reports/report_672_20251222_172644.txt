On April 15, 2024, security analysts at a fictional multinational corporation, 'GlobalTech Inc.', detected anomalous activity in their hybrid infrastructure, which includes on-premises Windows servers and cloud-based Azure and AWS environments. GlobalTech, a manufacturer with offices in North America and Europe, reported unusual network traffic patterns originating from their Apache web servers, which host customer portals and internal applications. Initial logs showed increased CPU usage on web servers, but no immediate alerts were triggered by their SIEM system, which had been tuned for common malware signatures but lacked behavioral analytics.

In the Initial Access phase, the threat actors likely conducted reconnaissance [T1589] to identify target email accounts, though specific logs were not available due to retention policies. They then deployed a phishing script, 'phishing.ps1', via a spear-phishing campaign to harvest credentials from fake authentication portals [T1586.002], which led to the compromise of a global administrator account in Azure AD. Using this access, the actors leveraged Service Principal credentials in Exchange to move laterally into cloud resources [T1078.004], while simultaneously modifying the Apache SSL configuration to install a compromised digital certificate stored at /etc/httpd/ssl/evil.crt [T1608.003] to facilitate man-in-the-middle attacks and evade detection.

During the Execution phase, the malware employed bash -c as a command and scripting interpreter [T1059] to run commands that exfiltrated sensitive files, such as financial records and intellectual property, to an external IP address, while also using Mimikatz to extract cached domain passwords from memory [T1003.005] for credential harvesting. The actors further exploited remote services by utilizing a PoshC2 module to target SMB via EternalBlue [T1210], enabling lateral movement across the network and persistence through scheduled tasks [T1053.005] that ensured malware execution at regular intervals.

In the Persistence phase, the threat group utilized tools like Pacu to generate SSH and API keys for AWS infrastructure and additional API keys for other IAM users [T1098.001], establishing long-term access to cloud environments. Command and control (C2) communications were secured through encrypted channels, with PowGoop receiving encrypted commands from C2 servers [T1573], making network traffic analysis challenging. Additionally, the malware exploited a resource exhaustion vulnerability in the web application framework to launch endpoint denial of service attacks [T1499], disrupting business operations and creating distractions for security teams.

Irrelevant system logs from GlobalTech's network showed routine backup processes and user login attempts, which were not indicative of malicious activity. The company's background includes a recent merger with a smaller firm, leading to integration challenges in IT systems, but this was unrelated to the attack. Security analysts noted that the Apache servers had been patched for critical vulnerabilities six months prior, but misconfigurations in certificate management were overlooked during audits.