The Federal Bureau of Investigation (FBI), CISA, and NSA are releasing this joint Cybersecurity Advisory to provide training on a fictional advanced persistent threat (APT) campaign dubbed 'CloudShadow'. This report is based on simulated incident response data from a fictional manufacturing company, 'GlobalTech Inc.', which reported anomalous behavior in its Azure and on-premises Windows/Linux systems starting in early 2024. Background investigation revealed that GlobalTech Inc. had recently migrated critical workloads to a multi-cloud setup, with delegated administrator roles for third-party vendors, though no prior breaches were documented in their SIEM logs from Q4 2023.

Initial Access: The actors likely acquired scalable cloud infrastructure [T1583], such as virtual machines across multiple regions, to host and distribute malicious .MSI files [T1218.007] that initiated the infection chain via phishing emails with spoofed sender addresses. System logs from GlobalTech's mail server showed an increase in spam filter bypass attempts, though most were blocked.

Execution: Upon user execution, the malware abused verclsid.exe [T1218.012] to bypass application control and then employed PowerShell to call native Windows APIs [T1106], retrieving hard disk handles to prepare for shutdown commands while simultaneously using FindWindow to locate explorer.exe processes for ListPlanting code injection [T1055.015]. Incident responders noted unusual PowerShell script activity in Windows Event Logs with high memory usage spikes.

Persistence: The adversary exploited delegated administrator permissions in the cloud environment [T1199] to escalate privileges and then replaced Sticky Keys accessibility features within RDP sessions [T1546.008] to maintain backdoor access, while also modifying registry keys to associate .pdf files with a compromised viewer through runtime data manipulation [T1565.003]. On Linux systems, a rootkit was installed to continuously monitor and dump changes to the /etc/passwd and /etc/shadow files [T1003.008], with cron jobs set to run every hour.

Defense Evasion: Attackers used space after filename techniques [T1036.006], renaming 'update.bat' to 'security_update.pdf ' to evade user suspicion and endpoint detection, and they invoked driverquery.exe with /fo table parameters [T1652] to list device drivers and identify vulnerabilities for potential exploitation. Network traffic analysis showed encrypted packets to unknown IPs, but firewall logs were incomplete due to a misconfiguration.

Discovery: The malware executed gpresult /h report.html [T1615] to export Group Policy results to an HTML file for later analysis of domain settings, and it scanned system directories for configuration files, though no data exfiltration was confirmed in this simulation.

Command and Control (C2): RDAT malware components utilized email attachments over SMTP protocols [T1071.003] for C2 communications, embedding encrypted commands in seemingly benign documents, with network sensors detecting unusual outbound traffic on port 587 during off-hours.

Impact: In the final stage, the KillDisk component called native APIs [T1106] to forcibly shut down machines, causing operational disruption at GlobalTech's production facilities, with recovery requiring system restores from backups; no ransom demands were observed, aligning with fictional destructive intent for training purposes. Post-incident, blue teams identified gaps in cloud permission reviews and enhanced monitoring for API anomalies.